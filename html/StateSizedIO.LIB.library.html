<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>StateSizedIO.LIB.library</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="StateSizedIO.LIB.library.html" class="Module">StateSizedIO.LIB.library</a> <a id="33" class="Keyword">where</a>

<a id="40" class="Keyword">open</a> <a id="45" class="Keyword">import</a> <a id="52" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="96" class="Keyword">hiding</a> <a id="103" class="Symbol">(</a><a id="104" href="Data.String.Base.html#2430" class="Function">length</a><a id="110" class="Symbol">;</a><a id="111" href="Data.String.Base.html#2613" class="Function">intersperse</a><a id="122" class="Symbol">)</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="Function.html" class="Module">Function</a>
<a id="145" class="Keyword">open</a> <a id="150" class="Keyword">import</a> <a id="157" href="Data.String.html" class="Module">Data.String</a> <a id="169" class="Keyword">renaming</a> <a id="178" class="Symbol">(</a><a id="179" href="Data.String.Base.html#2366" class="Function Operator">_++_</a> <a id="184" class="Symbol">to</a> <a id="187" class="Function Operator">_++Str_</a><a id="194" class="Symbol">)</a> <a id="196" class="Keyword">hiding</a> <a id="203" class="Symbol">(</a><a id="204" href="Data.String.Base.html#2430" class="Function">length</a><a id="210" class="Symbol">;</a><a id="211" href="Data.String.Base.html#2613" class="Function">intersperse</a><a id="222" class="Symbol">)</a>
<a id="224" class="Keyword">open</a> <a id="229" class="Keyword">import</a> <a id="236" href="Data.List.html" class="Module">Data.List</a>
<a id="246" class="Keyword">open</a> <a id="251" class="Keyword">import</a> <a id="258" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="267" class="Keyword">hiding</a> <a id="274" class="Symbol">(</a><a id="275" href="Data.Fin.Base.html#1340" class="Function">toℕ</a><a id="278" class="Symbol">)</a> <a id="280" class="Keyword">renaming</a> <a id="289" class="Symbol">(</a><a id="290" href="Data.Fin.Base.html#6178" class="Function Operator">_+_</a> <a id="294" class="Symbol">to</a> <a id="297" class="Function Operator">_+,_</a><a id="301" class="Symbol">;</a><a id="302" href="Data.Fin.Base.html#8044" class="Function Operator">_&lt;_</a> <a id="306" class="Symbol">to</a> <a id="309" class="Function Operator">_&lt;F_</a><a id="313" class="Symbol">)</a>

<a id="316" class="Keyword">open</a> <a id="321" class="Keyword">import</a> <a id="328" href="Agda.Builtin.Char.html" class="Module">Agda.Builtin.Char</a>
<a id="346" class="Keyword">open</a> <a id="351" class="Keyword">import</a> <a id="358" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="369" class="Keyword">hiding</a> <a id="376" class="Symbol">(</a><a id="377" href="Data.Maybe.Base.html#2020" class="Function">map</a><a id="380" class="Symbol">)</a>

<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="410" class="Keyword">open</a> <a id="415" class="Keyword">import</a> <a id="422" href="Category.Monad.Indexed.html" class="Module">Category.Monad.Indexed</a>
<a id="445" class="Keyword">open</a> <a id="450" class="Keyword">import</a> <a id="457" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a> <a id="477" class="Keyword">using</a> <a id="483" class="Symbol">(</a><a id="484" href="Agda.Builtin.String.html#559" class="Primitive">primStringEquality</a><a id="502" class="Symbol">)</a>
<a id="504" class="Keyword">open</a> <a id="509" class="Keyword">import</a> <a id="516" href="Data.Char.html" class="Module">Data.Char</a> <a id="526" class="Keyword">hiding</a> <a id="533" class="Symbol">(</a><a id="534" href="Data.Char.Base.html#822" class="Primitive">isDigit</a><a id="541" class="Symbol">)</a>
<a id="543" class="Keyword">open</a> <a id="548" class="Keyword">import</a> <a id="555" href="Data.Nat.html" class="Module">Data.Nat</a>


<a id="566" class="Keyword">open</a> <a id="571" class="Keyword">import</a> <a id="578" href="NativeIO.html" class="Module">NativeIO</a>


<a id="elemStr"></a><a id="589" href="StateSizedIO.LIB.library.html#589" class="Function">elemStr</a> <a id="597" class="Symbol">:</a> <a id="599" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="606" class="Symbol">→</a> <a id="608" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="613" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="620" class="Symbol">→</a> <a id="622" href="Agda.Builtin.Bool.html#147" class="Datatype">Bool</a>
<a id="627" href="StateSizedIO.LIB.library.html#589" class="Function">elemStr</a> <a id="635" class="Symbol">=</a> <a id="637" href="Data.List.Base.html#4677" class="Function">any</a> <a id="641" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="643" href="Agda.Builtin.String.html#559" class="Primitive">primStringEquality</a>

<a id="concatStr"></a><a id="663" href="StateSizedIO.LIB.library.html#663" class="Function">concatStr</a> <a id="673" class="Symbol">:</a> <a id="675" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="680" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="687" class="Symbol">→</a> <a id="689" href="Agda.Builtin.String.html#309" class="Postulate">String</a>
<a id="696" href="StateSizedIO.LIB.library.html#663" class="Function">concatStr</a> <a id="706" class="Symbol">=</a> <a id="708" href="Data.List.Base.html#4192" class="Function">foldr</a> <a id="714" href="StateSizedIO.LIB.library.html#187" class="Function Operator">_++Str_</a> <a id="722" class="String">&quot;&quot;</a>

<a id="726" class="Comment">-- concatIntersperse &quot;, &quot; (&quot;hey&quot; ∷ &quot;there&quot; ∷ []) ==&gt; &quot;hey, there&quot;</a>
<a id="concatIntersperse"></a><a id="792" href="StateSizedIO.LIB.library.html#792" class="Function">concatIntersperse</a> <a id="810" class="Symbol">:</a> <a id="812" class="Symbol">(</a><a id="813" href="StateSizedIO.LIB.library.html#813" class="Bound">x</a> <a id="815" class="Symbol">:</a> <a id="817" href="Agda.Builtin.String.html#309" class="Postulate">String</a><a id="823" class="Symbol">)</a> <a id="825" class="Symbol">(</a><a id="826" href="StateSizedIO.LIB.library.html#826" class="Bound">y</a> <a id="828" class="Symbol">:</a> <a id="830" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="835" href="Agda.Builtin.String.html#309" class="Postulate">String</a><a id="841" class="Symbol">)</a> <a id="843" class="Symbol">→</a> <a id="845" href="Agda.Builtin.String.html#309" class="Postulate">String</a>
<a id="852" href="StateSizedIO.LIB.library.html#792" class="Function">concatIntersperse</a> <a id="870" href="StateSizedIO.LIB.library.html#870" class="Bound">intersperseStr</a> <a id="885" href="StateSizedIO.LIB.library.html#885" class="Bound">list</a> <a id="890" class="Symbol">=</a> <a id="892" href="StateSizedIO.LIB.library.html#663" class="Function">concatStr</a> <a id="902" class="Symbol">(</a><a id="903" href="Data.List.Base.html#1895" class="Function">intersperse</a> <a id="915" href="StateSizedIO.LIB.library.html#870" class="Bound">intersperseStr</a> <a id="930" href="StateSizedIO.LIB.library.html#885" class="Bound">list</a><a id="934" class="Symbol">)</a>

<a id="charToDecDigitNat"></a><a id="937" href="StateSizedIO.LIB.library.html#937" class="Function">charToDecDigitNat</a> <a id="955" class="Symbol">:</a> <a id="957" href="Agda.Builtin.Char.html#212" class="Postulate">Char</a> <a id="962" class="Symbol">-&gt;</a> <a id="965" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a>
<a id="967" href="StateSizedIO.LIB.library.html#937" class="Function">charToDecDigitNat</a> <a id="985" href="StateSizedIO.LIB.library.html#985" class="Bound">c</a> <a id="987" class="Symbol">=</a> <a id="989" class="Symbol">(</a><a id="990" href="Data.Char.Base.html#1123" class="Primitive">toℕ</a> <a id="994" href="StateSizedIO.LIB.library.html#985" class="Bound">c</a><a id="995" class="Symbol">)</a> <a id="997" href="Data.Nat.Base.html#2935" class="Primitive Operator">∸</a> <a id="999" class="Number">48</a>

<a id="readNat"></a><a id="1003" href="StateSizedIO.LIB.library.html#1003" class="Function">readNat</a> <a id="1011" class="Symbol">:</a> <a id="1013" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1018" href="Agda.Builtin.Char.html#212" class="Postulate">Char</a> <a id="1023" class="Symbol">-&gt;</a> <a id="1026" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a>                 <a id="1044" class="Comment">-- convert from decimal digit chars</a>
<a id="1080" href="StateSizedIO.LIB.library.html#1003" class="Function">readNat</a> <a id="1088" class="Symbol">=</a>  <a id="1091" href="StateSizedIO.LIB.library.html#1157" class="Function">toN</a> <a id="1095" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="1097" href="Data.List.Base.html#1544" class="Function">map</a> <a id="1101" href="StateSizedIO.LIB.library.html#937" class="Function">charToDecDigitNat</a> <a id="1119" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="1121" href="Data.List.Base.html#9817" class="Function">reverse</a>
           <a id="1140" class="Keyword">where</a>
           <a id="1157" href="StateSizedIO.LIB.library.html#1157" class="Function">toN</a> <a id="1161" class="Symbol">:</a> <a id="1163" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1168" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a> <a id="1170" class="Symbol">-&gt;</a> <a id="1173" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a>
           <a id="1186" href="StateSizedIO.LIB.library.html#1157" class="Function">toN</a> <a id="1190" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="1199" class="Symbol">=</a> <a id="1201" class="Number">0</a>
           <a id="1214" href="StateSizedIO.LIB.library.html#1157" class="Function">toN</a> <a id="1218" class="Symbol">(</a><a id="1219" href="StateSizedIO.LIB.library.html#1219" class="Bound">j</a> <a id="1221" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1223" href="StateSizedIO.LIB.library.html#1223" class="Bound">js</a><a id="1225" class="Symbol">)</a> <a id="1227" class="Symbol">=</a> <a id="1229" href="StateSizedIO.LIB.library.html#1219" class="Bound">j</a> <a id="1231" href="Agda.Builtin.Nat.html#310" class="Primitive Operator">+</a> <a id="1233" class="Symbol">(</a><a id="1234" class="Number">10</a> <a id="1237" href="Agda.Builtin.Nat.html#513" class="Primitive Operator">*</a> <a id="1239" class="Symbol">(</a><a id="1240" href="StateSizedIO.LIB.library.html#1157" class="Function">toN</a> <a id="1244" href="StateSizedIO.LIB.library.html#1223" class="Bound">js</a><a id="1246" class="Symbol">))</a>

<a id="isDigit"></a><a id="1250" href="StateSizedIO.LIB.library.html#1250" class="Function">isDigit</a> <a id="1258" class="Symbol">:</a> <a id="1260" href="Agda.Builtin.Char.html#212" class="Postulate">Char</a> <a id="1265" class="Symbol">→</a> <a id="1267" href="Agda.Builtin.Bool.html#147" class="Datatype">Bool</a>
<a id="1272" href="StateSizedIO.LIB.library.html#1250" class="Function">isDigit</a> <a id="1280" class="Symbol">=</a> <a id="1282" href="Agda.Builtin.Char.html#274" class="Primitive">primIsDigit</a>

<a id="strIsNatNumber"></a><a id="1295" href="StateSizedIO.LIB.library.html#1295" class="Function">strIsNatNumber</a> <a id="1310" class="Symbol">:</a> <a id="1312" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="1319" class="Symbol">→</a> <a id="1321" href="Agda.Builtin.Bool.html#147" class="Datatype">Bool</a>
<a id="1326" href="StateSizedIO.LIB.library.html#1295" class="Function">strIsNatNumber</a> <a id="1341" href="StateSizedIO.LIB.library.html#1341" class="Bound">s</a> <a id="1343" class="Symbol">=</a> <a id="1345" href="Data.List.Base.html#4730" class="Function">all</a> <a id="1349" href="StateSizedIO.LIB.library.html#1250" class="Function">isDigit</a> <a id="1357" class="Symbol">(</a><a id="1358" href="Data.String.Base.html#1493" class="Primitive">toList</a> <a id="1365" href="StateSizedIO.LIB.library.html#1341" class="Bound">s</a><a id="1366" class="Symbol">)</a>


<a id="stringToNat"></a><a id="1370" href="StateSizedIO.LIB.library.html#1370" class="Function">stringToNat</a> <a id="1382" class="Symbol">:</a> <a id="1384" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="1391" class="Symbol">→</a> <a id="1393" href="Agda.Builtin.Maybe.html#109" class="Datatype">Maybe</a> <a id="1399" href="Agda.Builtin.Nat.html#177" class="Datatype">ℕ</a>
<a id="1401" href="StateSizedIO.LIB.library.html#1370" class="Function">stringToNat</a> <a id="1413" href="StateSizedIO.LIB.library.html#1413" class="Bound">s</a> <a id="1415" class="Keyword">with</a> <a id="1420" class="Symbol">(</a><a id="1421" href="StateSizedIO.LIB.library.html#1295" class="Function">strIsNatNumber</a> <a id="1436" href="StateSizedIO.LIB.library.html#1413" class="Bound">s</a><a id="1437" class="Symbol">)</a>
<a id="1439" class="Symbol">...</a> <a id="1443" class="Symbol">|</a> <a id="1445" href="Agda.Builtin.Bool.html#172" class="InductiveConstructor">true</a> <a id="1450" class="Symbol">=</a> <a id="1452" href="Agda.Builtin.Maybe.html#147" class="InductiveConstructor">just</a> <a id="1457" class="Symbol">((</a><a id="1459" href="StateSizedIO.LIB.library.html#1003" class="Function">readNat</a> <a id="1467" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="1469" href="Data.String.Base.html#1493" class="Primitive">toList</a><a id="1475" class="Symbol">)</a> <a id="1477" class="Bound">s</a><a id="1478" class="Symbol">)</a>
<a id="1480" class="Symbol">...</a> <a id="1484" class="Symbol">|</a> <a id="1486" href="Agda.Builtin.Bool.html#166" class="InductiveConstructor">false</a> <a id="1492" class="Symbol">=</a> <a id="1494" href="Agda.Builtin.Maybe.html#168" class="InductiveConstructor">nothing</a>


<a id="nth"></a><a id="1504" href="StateSizedIO.LIB.library.html#1504" class="Function">nth</a> <a id="1508" class="Symbol">:</a> <a id="1510" class="Symbol">{</a><a id="1511" href="StateSizedIO.LIB.library.html#1511" class="Bound">A</a> <a id="1513" class="Symbol">:</a> <a id="1515" href="Agda.Primitive.html#311" class="Primitive">Set</a><a id="1518" class="Symbol">}</a> <a id="1520" class="Symbol">→</a> <a id="1522" class="Symbol">(</a><a id="1523" href="StateSizedIO.LIB.library.html#1523" class="Bound">l</a> <a id="1525" class="Symbol">:</a> <a id="1527" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1532" href="StateSizedIO.LIB.library.html#1511" class="Bound">A</a><a id="1533" class="Symbol">)</a> <a id="1535" class="Symbol">→</a> <a id="1537" href="Data.Fin.Base.html#1214" class="Datatype">Fin</a> <a id="1541" class="Symbol">(</a><a id="1542" href="Data.List.Base.html#4864" class="Function">length</a> <a id="1549" href="StateSizedIO.LIB.library.html#1523" class="Bound">l</a><a id="1550" class="Symbol">)</a> <a id="1552" class="Symbol">→</a> <a id="1554" href="StateSizedIO.LIB.library.html#1511" class="Bound">A</a>
<a id="1556" href="StateSizedIO.LIB.library.html#1504" class="Function">nth</a> <a id="1560" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="1563" class="Symbol">()</a>
<a id="1566" href="StateSizedIO.LIB.library.html#1504" class="Function">nth</a> <a id="1570" class="Symbol">(</a><a id="1571" href="StateSizedIO.LIB.library.html#1571" class="Bound">a</a> <a id="1573" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1575" href="StateSizedIO.LIB.library.html#1575" class="Bound">l</a><a id="1576" class="Symbol">)</a> <a id="1578" href="Data.Fin.Base.html#1236" class="InductiveConstructor">zero</a> <a id="1583" class="Symbol">=</a> <a id="1585" href="StateSizedIO.LIB.library.html#1571" class="Bound">a</a>
<a id="1587" href="StateSizedIO.LIB.library.html#1504" class="Function">nth</a> <a id="1591" class="Symbol">(</a><a id="1592" href="StateSizedIO.LIB.library.html#1592" class="Bound">a</a> <a id="1594" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1596" href="StateSizedIO.LIB.library.html#1596" class="Bound">l</a><a id="1597" class="Symbol">)</a> <a id="1599" class="Symbol">(</a><a id="1600" href="Data.Fin.Base.html#1267" class="InductiveConstructor">suc</a> <a id="1604" href="StateSizedIO.LIB.library.html#1604" class="Bound">n</a><a id="1605" class="Symbol">)</a> <a id="1607" class="Symbol">=</a> <a id="1609" href="StateSizedIO.LIB.library.html#1504" class="Function">nth</a> <a id="1613" href="StateSizedIO.LIB.library.html#1596" class="Bound">l</a> <a id="1615" href="StateSizedIO.LIB.library.html#1604" class="Bound">n</a>


<a id="ioMonad"></a><a id="1619" href="StateSizedIO.LIB.library.html#1619" class="Function">ioMonad</a> <a id="1627" class="Symbol">:</a> <a id="1629" href="Category.Monad.html#448" class="Function">RawMonad</a> <a id="1638" href="NativeIO.html#260" class="Postulate">NativeIO</a>
<a id="1647" href="Category.Monad.Indexed.html#644" class="Field">RawIMonad.return</a> <a id="1664" href="StateSizedIO.LIB.library.html#1619" class="Function">ioMonad</a> <a id="1672" class="Symbol">=</a> <a id="1674" href="NativeIO.html#287" class="Postulate">nativeReturn</a>
<a id="1687" href="Category.Monad.Indexed.html#677" class="Field Operator">RawIMonad._&gt;&gt;=_</a> <a id="1703" href="StateSizedIO.LIB.library.html#1619" class="Function">ioMonad</a> <a id="1711" class="Symbol">=</a> <a id="1713" href="NativeIO.html#331" class="Postulate Operator">_native&gt;&gt;=_</a>
</pre></body></html>