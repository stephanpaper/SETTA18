<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>StateSizedIO.LIB.library</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="StateSizedIO.LIB.library.html" class="Module">StateSizedIO.LIB.library</a> <a id="33" class="Keyword">where</a>

<a id="40" class="Keyword">open</a> <a id="45" class="Keyword">import</a> <a id="52" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="96" class="Keyword">hiding</a> <a id="103" class="Symbol">(</a><a id="104" href="Data.String.Base.html#1158" class="Function">length</a><a id="110" class="Symbol">)</a>
<a id="112" class="Keyword">open</a> <a id="117" class="Keyword">import</a> <a id="124" href="Function.html" class="Module">Function</a>
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Data.String.html" class="Module">Data.String</a> <a id="157" class="Keyword">renaming</a> <a id="166" class="Symbol">(</a><a id="167" href="Data.String.Base.html#1101" class="Function Operator">_++_</a> <a id="172" class="Symbol">to</a> <a id="175" href="Data.String.Base.html#1101" class="Function Operator">_++Str_</a><a id="182" class="Symbol">)</a> <a id="184" class="Keyword">hiding</a> <a id="191" class="Symbol">(</a><a id="192" href="Data.String.Base.html#1158" class="Function">length</a><a id="198" class="Symbol">)</a>
<a id="200" class="Keyword">open</a> <a id="205" class="Keyword">import</a> <a id="212" href="Data.List.html" class="Module">Data.List</a>
<a id="222" class="Keyword">open</a> <a id="227" class="Keyword">import</a> <a id="234" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="243" class="Keyword">renaming</a> <a id="252" class="Symbol">(</a><a id="253" href="Data.Fin.html#3869" class="Function Operator">_+_</a> <a id="257" class="Symbol">to</a> <a id="260" href="Data.Fin.html#3869" class="Function Operator">_+,_</a><a id="264" class="Symbol">;</a><a id="265" href="Data.Fin.html#5684" class="Function Operator">_&lt;_</a> <a id="269" class="Symbol">to</a> <a id="272" href="Data.Fin.html#5684" class="Function Operator">_&lt;F_</a><a id="276" class="Symbol">)</a>

<a id="279" class="Keyword">open</a> <a id="284" class="Keyword">import</a> <a id="291" href="Agda.Builtin.Char.html" class="Module">Agda.Builtin.Char</a>
<a id="309" class="Keyword">open</a> <a id="314" class="Keyword">import</a> <a id="321" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="332" class="Keyword">hiding</a> <a id="339" class="Symbol">(</a><a id="340" href="Data.Maybe.Base.html#1971" class="Function">map</a><a id="343" class="Symbol">)</a>

<a id="346" class="Keyword">open</a> <a id="351" class="Keyword">import</a> <a id="358" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="373" class="Keyword">open</a> <a id="378" class="Keyword">import</a> <a id="385" href="Category.Monad.Indexed.html" class="Module">Category.Monad.Indexed</a>



<a id="411" class="Keyword">open</a> <a id="416" class="Keyword">import</a> <a id="423" href="NativeIO.html" class="Module">NativeIO</a>


<a id="elemStr"></a><a id="434" href="StateSizedIO.LIB.library.html#434" class="Function">elemStr</a> <a id="442" class="Symbol">:</a> <a id="444" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="451" class="Symbol">→</a> <a id="453" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="458" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="465" class="Symbol">→</a> <a id="467" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a>
<a id="472" href="StateSizedIO.LIB.library.html#434" class="Function">elemStr</a> <a id="480" class="Symbol">=</a> <a id="482" href="Data.List.Base.html#3015" class="Function">any</a> <a id="486" href="Function.html#759" class="Function Operator">∘</a> <a id="488" href="Agda.Builtin.String.html#353" class="Primitive">primStringEquality</a>

<a id="concatStr"></a><a id="508" href="StateSizedIO.LIB.library.html#508" class="Function">concatStr</a> <a id="518" class="Symbol">:</a> <a id="520" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="525" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="532" class="Symbol">→</a> <a id="534" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
<a id="541" href="StateSizedIO.LIB.library.html#508" class="Function">concatStr</a> <a id="551" class="Symbol">=</a> <a id="553" href="Data.List.Base.html#2376" class="Function">foldr</a> <a id="559" href="Data.String.Base.html#1101" class="Function Operator">_++Str_</a> <a id="567" class="String">&quot;&quot;</a>

<a id="571" class="Comment">-- concatIntersperse &quot;, &quot; (&quot;hey&quot; ∷ &quot;there&quot; ∷ []) ==&gt; &quot;hey, there&quot;</a>
<a id="concatIntersperse"></a><a id="637" href="StateSizedIO.LIB.library.html#637" class="Function">concatIntersperse</a> <a id="655" class="Symbol">:</a> <a id="657" class="Symbol">(</a><a id="658" href="StateSizedIO.LIB.library.html#658" class="Bound">x</a> <a id="660" class="Symbol">:</a> <a id="662" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="668" class="Symbol">)</a> <a id="670" class="Symbol">(</a><a id="671" href="StateSizedIO.LIB.library.html#671" class="Bound">y</a> <a id="673" class="Symbol">:</a> <a id="675" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="680" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="686" class="Symbol">)</a> <a id="688" class="Symbol">→</a> <a id="690" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
<a id="697" href="StateSizedIO.LIB.library.html#637" class="Function">concatIntersperse</a> <a id="715" href="StateSizedIO.LIB.library.html#715" class="Bound">intersperseStr</a> <a id="730" href="StateSizedIO.LIB.library.html#730" class="Bound">list</a> <a id="735" class="Symbol">=</a> <a id="737" href="StateSizedIO.LIB.library.html#508" class="Function">concatStr</a> <a id="747" class="Symbol">(</a><a id="748" href="Data.List.Base.html#1496" class="Function">intersperse</a> <a id="760" href="StateSizedIO.LIB.library.html#715" class="Bound">intersperseStr</a> <a id="775" href="StateSizedIO.LIB.library.html#730" class="Bound">list</a><a id="779" class="Symbol">)</a>



<a id="784" class="Keyword">open</a> <a id="789" class="Keyword">import</a> <a id="796" href="Data.Char.html" class="Module">Data.Char</a>
<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="Data.Nat.html" class="Module">Data.Nat</a>

<a id="charToDecDigitNat"></a><a id="828" href="StateSizedIO.LIB.library.html#828" class="Function">charToDecDigitNat</a> <a id="846" class="Symbol">:</a> <a id="848" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a> <a id="853" class="Symbol">-&gt;</a> <a id="856" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
<a id="858" href="StateSizedIO.LIB.library.html#828" class="Function">charToDecDigitNat</a> <a id="876" href="StateSizedIO.LIB.library.html#876" class="Bound">c</a> <a id="878" class="Symbol">=</a> <a id="880" class="Symbol">(</a><a id="881" href="Data.Char.Base.html#1131" class="Function">toNat</a> <a id="887" href="StateSizedIO.LIB.library.html#876" class="Bound">c</a><a id="888" class="Symbol">)</a> <a id="890" href="Agda.Builtin.Nat.html#320" class="Primitive Operator">∸</a> <a id="892" class="Number">48</a>

<a id="readNat"></a><a id="896" href="StateSizedIO.LIB.library.html#896" class="Function">readNat</a> <a id="904" class="Symbol">:</a> <a id="906" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="911" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a> <a id="916" class="Symbol">-&gt;</a> <a id="919" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>                 <a id="937" class="Comment">-- convert from decimal digit chars</a>
<a id="973" href="StateSizedIO.LIB.library.html#896" class="Function">readNat</a> <a id="981" class="Symbol">=</a>  <a id="984" href="StateSizedIO.LIB.library.html#1050" class="Function">toN</a> <a id="988" href="Function.html#759" class="Function Operator">∘</a> <a id="990" href="Data.List.Base.html#1057" class="Function">map</a> <a id="994" href="StateSizedIO.LIB.library.html#828" class="Function">charToDecDigitNat</a> <a id="1012" href="Function.html#759" class="Function Operator">∘</a> <a id="1014" href="Data.List.Base.html#7225" class="Function">reverse</a>
           <a id="1033" class="Keyword">where</a>
           <a id="1050" href="StateSizedIO.LIB.library.html#1050" class="Function">toN</a> <a id="1054" class="Symbol">:</a> <a id="1056" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1061" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1063" class="Symbol">-&gt;</a> <a id="1066" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
           <a id="1079" href="StateSizedIO.LIB.library.html#1050" class="Function">toN</a> <a id="1083" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>       <a id="1092" class="Symbol">=</a> <a id="1094" class="Number">0</a>
           <a id="1107" href="StateSizedIO.LIB.library.html#1050" class="Function">toN</a> <a id="1111" class="Symbol">(</a><a id="1112" href="StateSizedIO.LIB.library.html#1112" class="Bound">j</a> <a id="1114" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1116" href="StateSizedIO.LIB.library.html#1116" class="Bound">js</a><a id="1118" class="Symbol">)</a> <a id="1120" class="Symbol">=</a> <a id="1122" href="StateSizedIO.LIB.library.html#1112" class="Bound">j</a> <a id="1124" href="Agda.Builtin.Nat.html#230" class="Primitive Operator">+</a> <a id="1126" class="Symbol">(</a><a id="1127" class="Number">10</a> <a id="1130" href="Agda.Builtin.Nat.html#433" class="Primitive Operator">*</a> <a id="1132" class="Symbol">(</a><a id="1133" href="StateSizedIO.LIB.library.html#1050" class="Function">toN</a> <a id="1137" href="StateSizedIO.LIB.library.html#1116" class="Bound">js</a><a id="1139" class="Symbol">))</a>

<a id="isDigit"></a><a id="1143" href="StateSizedIO.LIB.library.html#1143" class="Function">isDigit</a> <a id="1151" class="Symbol">:</a> <a id="1153" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a> <a id="1158" class="Symbol">→</a> <a id="1160" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a>
<a id="1165" href="StateSizedIO.LIB.library.html#1143" class="Function">isDigit</a> <a id="1173" class="Symbol">=</a> <a id="1175" href="Agda.Builtin.Char.html#194" class="Primitive">primIsDigit</a>

<a id="strIsNatNumber"></a><a id="1188" href="StateSizedIO.LIB.library.html#1188" class="Function">strIsNatNumber</a> <a id="1203" class="Symbol">:</a> <a id="1205" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1212" class="Symbol">→</a> <a id="1214" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a>
<a id="1219" href="StateSizedIO.LIB.library.html#1188" class="Function">strIsNatNumber</a> <a id="1234" href="StateSizedIO.LIB.library.html#1234" class="Bound">s</a> <a id="1236" class="Symbol">=</a> <a id="1238" href="Data.List.Base.html#3088" class="Function">all</a> <a id="1242" href="StateSizedIO.LIB.library.html#1143" class="Function">isDigit</a> <a id="1250" class="Symbol">(</a><a id="1251" href="Data.String.Base.html#947" class="Function">toList</a> <a id="1258" href="StateSizedIO.LIB.library.html#1234" class="Bound">s</a><a id="1259" class="Symbol">)</a>


<a id="stringToNat"></a><a id="1263" href="StateSizedIO.LIB.library.html#1263" class="Function">stringToNat</a> <a id="1275" class="Symbol">:</a> <a id="1277" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1284" class="Symbol">→</a> <a id="1286" href="Data.Maybe.Base.html#335" class="Datatype">Maybe</a> <a id="1292" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
<a id="1294" href="StateSizedIO.LIB.library.html#1263" class="Function">stringToNat</a> <a id="1306" href="StateSizedIO.LIB.library.html#1306" class="Bound">s</a> <a id="1308" class="Keyword">with</a> <a id="1313" class="Symbol">(</a><a id="1314" href="StateSizedIO.LIB.library.html#1188" class="Function">strIsNatNumber</a> <a id="1329" href="StateSizedIO.LIB.library.html#1306" class="Bound">s</a><a id="1330" class="Symbol">)</a>
<a id="1332" class="Symbol">...</a> <a id="1336" class="Symbol">|</a> <a id="1338" href="Agda.Builtin.Bool.html#92" class="InductiveConstructor">true</a> <a id="1343" class="Symbol">=</a> <a id="1345" href="Data.Maybe.Base.html#373" class="InductiveConstructor">just</a> <a id="1350" class="Symbol">((</a><a id="1352" href="StateSizedIO.LIB.library.html#896" class="Function">readNat</a> <a id="1360" href="Function.html#759" class="Function Operator">∘</a> <a id="1362" href="Data.String.Base.html#947" class="Function">toList</a><a id="1368" class="Symbol">)</a> <a id="1370" class="Bound">s</a><a id="1371" class="Symbol">)</a>
<a id="1373" class="Symbol">...</a> <a id="1377" class="Symbol">|</a> <a id="1379" href="Agda.Builtin.Bool.html#86" class="InductiveConstructor">false</a> <a id="1385" class="Symbol">=</a> <a id="1387" href="Data.Maybe.Base.html#403" class="InductiveConstructor">nothing</a>


<a id="nth"></a><a id="1397" href="StateSizedIO.LIB.library.html#1397" class="Function">nth</a> <a id="1401" class="Symbol">:</a> <a id="1403" class="Symbol">{</a><a id="1404" href="StateSizedIO.LIB.library.html#1404" class="Bound">A</a> <a id="1406" class="Symbol">:</a> <a id="1408" class="PrimitiveType">Set</a><a id="1411" class="Symbol">}</a> <a id="1413" class="Symbol">→</a> <a id="1415" class="Symbol">(</a><a id="1416" href="StateSizedIO.LIB.library.html#1416" class="Bound">l</a> <a id="1418" class="Symbol">:</a> <a id="1420" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1425" href="StateSizedIO.LIB.library.html#1404" class="Bound">A</a><a id="1426" class="Symbol">)</a> <a id="1428" class="Symbol">→</a> <a id="1430" href="Data.Fin.html#910" class="Datatype">Fin</a> <a id="1434" class="Symbol">(</a><a id="1435" href="Data.List.Base.html#3242" class="Function">length</a> <a id="1442" href="StateSizedIO.LIB.library.html#1416" class="Bound">l</a><a id="1443" class="Symbol">)</a> <a id="1445" class="Symbol">→</a> <a id="1447" href="StateSizedIO.LIB.library.html#1404" class="Bound">A</a>
<a id="1449" href="StateSizedIO.LIB.library.html#1397" class="Function">nth</a> <a id="1453" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1456" class="Symbol">()</a>
<a id="1459" href="StateSizedIO.LIB.library.html#1397" class="Function">nth</a> <a id="1463" class="Symbol">(</a><a id="1464" href="StateSizedIO.LIB.library.html#1464" class="Bound">a</a> <a id="1466" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1468" href="StateSizedIO.LIB.library.html#1468" class="Bound">l</a><a id="1469" class="Symbol">)</a> <a id="1471" href="Data.Fin.html#932" class="InductiveConstructor">zero</a> <a id="1476" class="Symbol">=</a> <a id="1478" href="StateSizedIO.LIB.library.html#1464" class="Bound">a</a>
<a id="1480" href="StateSizedIO.LIB.library.html#1397" class="Function">nth</a> <a id="1484" class="Symbol">(</a><a id="1485" href="StateSizedIO.LIB.library.html#1485" class="Bound">a</a> <a id="1487" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1489" href="StateSizedIO.LIB.library.html#1489" class="Bound">l</a><a id="1490" class="Symbol">)</a> <a id="1492" class="Symbol">(</a><a id="1493" href="Data.Fin.html#963" class="InductiveConstructor">suc</a> <a id="1497" href="StateSizedIO.LIB.library.html#1497" class="Bound">n</a><a id="1498" class="Symbol">)</a> <a id="1500" class="Symbol">=</a> <a id="1502" href="StateSizedIO.LIB.library.html#1397" class="Function">nth</a> <a id="1506" href="StateSizedIO.LIB.library.html#1489" class="Bound">l</a> <a id="1508" href="StateSizedIO.LIB.library.html#1497" class="Bound">n</a>


<a id="ioMonad"></a><a id="1512" href="StateSizedIO.LIB.library.html#1512" class="Function">ioMonad</a> <a id="1520" class="Symbol">:</a> <a id="1522" href="Category.Monad.html#360" class="Function">RawMonad</a> <a id="1531" href="NativeIO.html#260" class="Postulate">NativeIO</a>
<a id="1540" href="Category.Monad.Indexed.html#533" class="Field">RawIMonad.return</a> <a id="1557" href="StateSizedIO.LIB.library.html#1512" class="Function">ioMonad</a> <a id="1565" class="Symbol">=</a> <a id="1567" href="NativeIO.html#287" class="Postulate">nativeReturn</a>
<a id="1580" href="Category.Monad.Indexed.html#568" class="Field Operator">RawIMonad._&gt;&gt;=_</a> <a id="1596" href="StateSizedIO.LIB.library.html#1512" class="Function">ioMonad</a> <a id="1604" class="Symbol">=</a> <a id="1606" href="NativeIO.html#331" class="Postulate Operator">_native&gt;&gt;=_</a>
</pre></body></html>