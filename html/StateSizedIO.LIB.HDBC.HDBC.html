<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>StateSizedIO.LIB.HDBC.HDBC</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="StateSizedIO.LIB.HDBC.HDBC.html" class="Module">StateSizedIO.LIB.HDBC.HDBC</a> <a id="35" class="Keyword">where</a>

<a id="42" class="Keyword">open</a> <a id="47" class="Keyword">import</a> <a id="54" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="69" class="Keyword">open</a> <a id="74" class="Keyword">import</a> <a id="81" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="120" class="Keyword">hiding</a> <a id="127" class="Symbol">(</a><a id="128" href="Agda.Builtin.Nat.html#310" class="Primitive Operator">_+_</a><a id="131" class="Symbol">)</a>
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="162" class="Keyword">renaming</a> <a id="171" class="Symbol">(</a><a id="172" href="Data.String.Base.html#2366" class="Function Operator">_++_</a> <a id="177" class="Symbol">to</a> <a id="180" class="Function Operator">_++Str_</a><a id="187" class="Symbol">)</a>

<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Data.Product.html" class="Module">Data.Product</a> <a id="215" class="Keyword">renaming</a> <a id="224" class="Symbol">(</a><a id="225" href="Data.Product.html#2486" class="Function">map</a> <a id="229" class="Symbol">to</a> <a id="232" class="Function">mapProduct</a><a id="242" class="Symbol">)</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Data.Integer.Show.html" class="Module">Data.Integer.Show</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Data.List.html" class="Module">Data.List</a>

<a id="322" class="Keyword">open</a> <a id="327" class="Keyword">import</a> <a id="334" href="Function.html" class="Module">Function</a>

<a id="344" class="Keyword">open</a> <a id="349" class="Keyword">import</a> <a id="356" href="StateSizedIO.LIB.library.html" class="Module">StateSizedIO.LIB.library</a>

<a id="382" class="Keyword">open</a> <a id="387" class="Keyword">import</a> <a id="394" href="NativeIO.html" class="Module">NativeIO</a> <a id="403" class="Keyword">renaming</a> <a id="412" class="Symbol">(</a><a id="413" href="NativeIO.html#260" class="Postulate">NativeIO</a> <a id="422" class="Symbol">to</a> <a id="425" class="Postulate">IO</a><a id="427" class="Symbol">;</a> <a id="429" href="NativeIO.html#287" class="Postulate">nativeReturn</a> <a id="442" class="Symbol">to</a> <a id="445" class="Postulate">return</a><a id="451" class="Symbol">;</a> <a id="453" href="NativeIO.html#331" class="Postulate Operator">_native&gt;&gt;=_</a> <a id="465" class="Symbol">to</a> <a id="468" class="Postulate Operator">_&gt;&gt;=_</a><a id="473" class="Symbol">)</a>


<a id="477" class="Comment">--</a>
<a id="480" class="Comment">-- TODO: implement lazy row retrevial as Toni suggested</a>
<a id="536" class="Comment">-- (Return a type for the lazy list and operations to get the next row)</a>
<a id="608" class="Comment">--</a>
<a id="611" class="Comment">--</a>

<a id="615" class="Comment">--</a>
<a id="618" class="Comment">-- TODO: once we use only our IO (not NativeIO)</a>
<a id="666" class="Comment">--       we must use consistently &quot;naitveFunctionName&quot; here (i.e., it is mixed/sometimes omitted)</a>
<a id="764" class="Comment">--</a>

<a id="768" class="Symbol">{-#</a> <a id="772" class="Keyword">FOREIGN</a> <a id="780" class="Pragma">GHC</a> <a id="784" class="Pragma">import</a> <a id="791" class="Pragma">qualified</a> <a id="801" class="Pragma">Database.HDBC.Sqlite3</a> <a id="823" class="Symbol">#-}</a>
<a id="827" class="Symbol">{-#</a> <a id="831" class="Keyword">FOREIGN</a> <a id="839" class="Pragma">GHC</a> <a id="843" class="Pragma">import</a> <a id="850" class="Pragma">qualified</a> <a id="860" class="Pragma">Database.HDBC</a> <a id="874" class="Symbol">#-}</a>
<a id="878" class="Symbol">{-#</a> <a id="882" class="Keyword">FOREIGN</a> <a id="890" class="Pragma">GHC</a> <a id="894" class="Pragma">import</a> <a id="901" class="Pragma">qualified</a> <a id="911" class="Pragma">Control.Monad</a> <a id="925" class="Symbol">#-}</a>
<a id="929" class="Symbol">{-#</a> <a id="933" class="Keyword">FOREIGN</a> <a id="941" class="Pragma">GHC</a> <a id="945" class="Pragma">import</a> <a id="952" class="Pragma">qualified</a> <a id="962" class="Pragma">Database.HDBC.SqlValue</a> <a id="985" class="Symbol">#-}</a>


<a id="991" class="Symbol">{-#</a> <a id="995" class="Keyword">FOREIGN</a> <a id="1003" class="Pragma">GHC</a> <a id="1007" class="Pragma">import</a> <a id="1014" class="Pragma">qualified</a> <a id="1024" class="Pragma">Data.ByteString</a> <a id="1040" class="Symbol">#-}</a>
<a id="1044" class="Symbol">{-#</a> <a id="1048" class="Keyword">FOREIGN</a> <a id="1056" class="Pragma">GHC</a> <a id="1060" class="Pragma">import</a> <a id="1067" class="Pragma">qualified</a> <a id="1077" class="Pragma">Data.Int</a> <a id="1086" class="Symbol">#-}</a>
<a id="1090" class="Symbol">{-#</a> <a id="1094" class="Keyword">FOREIGN</a> <a id="1102" class="Pragma">GHC</a> <a id="1106" class="Pragma">import</a> <a id="1113" class="Pragma">qualified</a> <a id="1123" class="Pragma">Data.ByteString.Char8</a> <a id="1145" class="Symbol">#-}</a>
<a id="1149" class="Symbol">{-#</a> <a id="1153" class="Keyword">FOREIGN</a> <a id="1161" class="Pragma">GHC</a> <a id="1165" class="Pragma">import</a> <a id="1172" class="Pragma">qualified</a> <a id="1182" class="Pragma">Data.Text</a> <a id="1192" class="Symbol">#-}</a>


<a id="1198" class="Comment">-- check later if we need safer conversion functions</a>
<a id="1251" class="Comment">--</a>

<a id="1255" class="Symbol">{-#</a> <a id="1259" class="Keyword">FOREIGN</a> <a id="1267" class="Pragma">GHC</a>
  <a id="1273" class="Pragma">data</a> <a id="1278" class="Pragma">SqlValueShort</a> <a id="1292" class="Pragma">=</a> <a id="1294" class="Pragma">SqlStringShort</a> <a id="1309" class="Pragma">Data.Text.Text</a>
                     <a id="1345" class="Pragma">|</a> <a id="1347" class="Pragma">SqlIntShort</a> <a id="1359" class="Pragma">Integer</a>
                     <a id="1388" class="Pragma">|</a> <a id="1390" class="Pragma">SqlNullShort</a>
                     <a id="1424" class="Pragma">|</a> <a id="1426" class="Pragma">SqlUndefinedShort</a>


  <a id="1448" class="Pragma">toSqlValueShort</a> <a id="1464" class="Pragma">::</a> <a id="1467" class="Pragma">Database.HDBC.SqlValue</a> <a id="1490" class="Pragma">-&gt;</a> <a id="1493" class="Pragma">SqlValueShort</a>
  <a id="1509" class="Pragma">toSqlValueShort</a> <a id="1525" class="Pragma">(Database.HDBC.SqlByteString</a> <a id="1554" class="Pragma">s)</a> <a id="1557" class="Pragma">=</a> <a id="1559" class="Pragma">SqlStringShort</a> <a id="1574" class="Pragma">$</a> <a id="1576" class="Pragma">Data.Text.pack</a> <a id="1591" class="Pragma">$</a> <a id="1593" class="Pragma">Data.ByteString.Char8.unpack</a>  <a id="1623" class="Pragma">s</a>
  <a id="1627" class="Pragma">toSqlValueShort</a> <a id="1643" class="Pragma">(Database.HDBC.SqlInt64</a> <a id="1667" class="Pragma">x)</a> <a id="1670" class="Pragma">=</a> <a id="1672" class="Pragma">SqlIntShort</a> <a id="1684" class="Pragma">$</a> <a id="1686" class="Pragma">fromIntegral</a> <a id="1699" class="Pragma">x</a>
  <a id="1703" class="Pragma">toSqlValueShort</a> <a id="1719" class="Pragma">Database.HDBC.SqlNull</a> <a id="1741" class="Pragma">=</a> <a id="1743" class="Pragma">SqlNullShort</a>
  <a id="1758" class="Pragma">toSqlValueShort</a> <a id="1774" class="Pragma">_</a> <a id="1776" class="Pragma">=</a> <a id="1778" class="Pragma">SqlUndefinedShort</a>

  <a id="1799" class="Pragma">--</a> <a id="1802" class="Pragma">throws</a> <a id="1809" class="Pragma">an</a> <a id="1812" class="Pragma">exception</a> <a id="1822" class="Pragma">(Non-exhaustive</a> <a id="1838" class="Pragma">patterns)</a> <a id="1848" class="Pragma">for</a> <a id="1852" class="Pragma">the</a> <a id="1856" class="Pragma">value</a> <a id="1862" class="Pragma">SqlUndefinedShort!</a>
  <a id="1883" class="Pragma">--</a>
  <a id="1888" class="Pragma">toSqlValue</a> <a id="1899" class="Pragma">::</a> <a id="1902" class="Pragma">SqlValueShort</a> <a id="1916" class="Pragma">-&gt;</a> <a id="1919" class="Pragma">Database.HDBC.SqlValue</a>
  <a id="1944" class="Pragma">toSqlValue</a> <a id="1955" class="Pragma">(SqlStringShort</a> <a id="1971" class="Pragma">str)</a> <a id="1976" class="Pragma">=</a>  <a id="1979" class="Pragma">Database.HDBC.SqlValue.SqlString</a> <a id="2012" class="Pragma">(Data.Text.unpack</a> <a id="2030" class="Pragma">str)</a>
  <a id="2037" class="Pragma">toSqlValue</a> <a id="2048" class="Pragma">(SqlIntShort</a> <a id="2061" class="Pragma">x)</a> <a id="2064" class="Pragma">=</a>  <a id="2067" class="Pragma">Database.HDBC.SqlValue.SqlInt64</a> <a id="2099" class="Pragma">(fromIntegral</a> <a id="2113" class="Pragma">x)</a>
  <a id="2118" class="Pragma">toSqlValue</a> <a id="2129" class="Pragma">SqlNullShort</a> <a id="2142" class="Pragma">=</a> <a id="2144" class="Pragma">Database.HDBC.SqlValue.SqlNull</a>
  <a id="2177" class="Pragma">toSqlValue</a> <a id="2188" class="Pragma">SqlUndefinedShort</a> <a id="2206" class="Pragma">=</a> <a id="2208" class="Pragma">error</a> <a id="2214" class="Pragma">&quot;ERROR!!!</a> <a id="2224" class="Pragma">toSqlValue</a> <a id="2235" class="Pragma">function</a> <a id="2244" class="Pragma">with</a> <a id="2249" class="Pragma">SqlUndefinedShort,</a> <a id="2268" class="Pragma">can&#39;t</a> <a id="2274" class="Pragma">convert</a> <a id="2282" class="Pragma">it.&quot;</a>

<a id="2288" class="Symbol">#-}</a>

<a id="2293" class="Keyword">data</a> <a id="SqlVal"></a><a id="2298" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a> <a id="2305" class="Symbol">:</a> <a id="2307" href="Agda.Primitive.html#311" class="Primitive">Set</a> <a id="2311" class="Keyword">where</a>
  <a id="SqlVal.sqlString"></a><a id="2319" href="StateSizedIO.LIB.HDBC.HDBC.html#2319" class="InductiveConstructor">sqlString</a>    <a id="2332" class="Symbol">:</a> <a id="2334" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="2341" class="Symbol">→</a> <a id="2343" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a>
  <a id="SqlVal.sqlInteger"></a><a id="2352" href="StateSizedIO.LIB.HDBC.HDBC.html#2352" class="InductiveConstructor">sqlInteger</a>   <a id="2365" class="Symbol">:</a> <a id="2367" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a> <a id="2369" class="Symbol">→</a> <a id="2371" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a>
  <a id="SqlVal.sqlNull"></a><a id="2380" href="StateSizedIO.LIB.HDBC.HDBC.html#2380" class="InductiveConstructor">sqlNull</a>      <a id="2393" class="Symbol">:</a> <a id="2395" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a>
  <a id="SqlVal.sqlUndefined"></a><a id="2404" href="StateSizedIO.LIB.HDBC.HDBC.html#2404" class="InductiveConstructor">sqlUndefined</a> <a id="2417" class="Symbol">:</a> <a id="2419" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a>

<a id="2427" class="Symbol">{-#</a> <a id="2431" class="Keyword">COMPILE</a> <a id="2439" class="Keyword">GHC</a> <a id="2443" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a> <a id="2450" class="Pragma">=</a> <a id="2452" class="Pragma">data</a> <a id="2457" class="Pragma">SqlValueShort</a> <a id="2471" class="Pragma">(SqlStringShort</a> <a id="2487" class="Pragma">|</a> <a id="2489" class="Pragma">SqlIntShort</a> <a id="2501" class="Pragma">|</a> <a id="2503" class="Pragma">SqlNullShort</a> <a id="2516" class="Pragma">|</a> <a id="2518" class="Pragma">SqlUndefinedShort)</a> <a id="2537" class="Symbol">#-}</a>


<a id="2543" class="Keyword">postulate</a> <a id="SqlValue"></a><a id="2553" href="StateSizedIO.LIB.HDBC.HDBC.html#2553" class="Postulate">SqlValue</a> <a id="2562" class="Symbol">:</a> <a id="2564" href="Agda.Primitive.html#311" class="Primitive">Set</a>
<a id="2568" class="Symbol">{-#</a> <a id="2572" class="Keyword">COMPILE</a> <a id="2580" class="Keyword">GHC</a> <a id="2584" href="StateSizedIO.LIB.HDBC.HDBC.html#2553" class="Postulate">SqlValue</a> <a id="2593" class="Pragma">=</a> <a id="2595" class="Pragma">type</a> <a id="2600" class="Pragma">Database.HDBC.SqlValue.SqlValue</a> <a id="2632" class="Symbol">#-}</a>

<a id="2637" class="Keyword">postulate</a> <a id="toSqlVal"></a><a id="2647" href="StateSizedIO.LIB.HDBC.HDBC.html#2647" class="Postulate">toSqlVal</a> <a id="2656" class="Symbol">:</a> <a id="2658" href="StateSizedIO.LIB.HDBC.HDBC.html#2553" class="Postulate">SqlValue</a> <a id="2667" class="Symbol">→</a> <a id="2669" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a>
<a id="2676" class="Symbol">{-#</a> <a id="2680" class="Keyword">COMPILE</a> <a id="2688" class="Keyword">GHC</a> <a id="2692" href="StateSizedIO.LIB.HDBC.HDBC.html#2647" class="Postulate">toSqlVal</a> <a id="2701" class="Pragma">=</a> <a id="2703" class="Pragma">toSqlValueShort</a> <a id="2719" class="Symbol">#-}</a>

<a id="2724" class="Keyword">postulate</a>  <a id="toSqlValue"></a><a id="2735" href="StateSizedIO.LIB.HDBC.HDBC.html#2735" class="Postulate">toSqlValue</a> <a id="2746" class="Symbol">:</a> <a id="2748" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a> <a id="2755" class="Symbol">→</a> <a id="2757" href="StateSizedIO.LIB.HDBC.HDBC.html#2553" class="Postulate">SqlValue</a>
<a id="2766" class="Symbol">{-#</a> <a id="2770" class="Keyword">COMPILE</a> <a id="2778" class="Keyword">GHC</a> <a id="2782" href="StateSizedIO.LIB.HDBC.HDBC.html#2735" class="Postulate">toSqlValue</a> <a id="2793" class="Pragma">=</a> <a id="2795" class="Pragma">toSqlValue</a> <a id="2806" class="Symbol">#-}</a>

<a id="toStringSqlVal"></a><a id="2811" href="StateSizedIO.LIB.HDBC.HDBC.html#2811" class="Function">toStringSqlVal</a> <a id="2826" class="Symbol">:</a> <a id="2828" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a> <a id="2835" class="Symbol">→</a> <a id="2837" href="Agda.Builtin.String.html#309" class="Postulate">String</a>
<a id="2844" href="StateSizedIO.LIB.HDBC.HDBC.html#2811" class="Function">toStringSqlVal</a> <a id="2859" class="Symbol">(</a><a id="2860" href="StateSizedIO.LIB.HDBC.HDBC.html#2319" class="InductiveConstructor">sqlString</a> <a id="2870" href="StateSizedIO.LIB.HDBC.HDBC.html#2870" class="Bound">s</a><a id="2871" class="Symbol">)</a>   <a id="2875" class="Symbol">=</a> <a id="2877" href="StateSizedIO.LIB.HDBC.HDBC.html#2870" class="Bound">s</a>
<a id="2879" href="StateSizedIO.LIB.HDBC.HDBC.html#2811" class="Function">toStringSqlVal</a> <a id="2894" class="Symbol">(</a><a id="2895" href="StateSizedIO.LIB.HDBC.HDBC.html#2352" class="InductiveConstructor">sqlInteger</a> <a id="2906" href="StateSizedIO.LIB.HDBC.HDBC.html#2906" class="Bound">x</a><a id="2907" class="Symbol">)</a>  <a id="2910" class="Symbol">=</a> <a id="2912" href="Data.Integer.Show.html#606" class="Function">Data.Integer.Show.show</a> <a id="2935" href="StateSizedIO.LIB.HDBC.HDBC.html#2906" class="Bound">x</a>
<a id="2937" href="StateSizedIO.LIB.HDBC.HDBC.html#2811" class="Function">toStringSqlVal</a> <a id="2952" href="StateSizedIO.LIB.HDBC.HDBC.html#2380" class="InductiveConstructor">sqlNull</a>         <a id="2968" class="Symbol">=</a> <a id="2970" class="String">&quot;SqlValNull&quot;</a>
<a id="2983" href="StateSizedIO.LIB.HDBC.HDBC.html#2811" class="Function">toStringSqlVal</a> <a id="2998" href="StateSizedIO.LIB.HDBC.HDBC.html#2404" class="InductiveConstructor">sqlUndefined</a>    <a id="3014" class="Symbol">=</a> <a id="3016" class="String">&quot;SqlValUndefined&quot;</a>

<a id="toTypeNameSqlVal"></a><a id="3035" href="StateSizedIO.LIB.HDBC.HDBC.html#3035" class="Function">toTypeNameSqlVal</a> <a id="3052" class="Symbol">:</a> <a id="3054" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a> <a id="3061" class="Symbol">→</a> <a id="3063" href="Agda.Builtin.String.html#309" class="Postulate">String</a>
<a id="3070" href="StateSizedIO.LIB.HDBC.HDBC.html#3035" class="Function">toTypeNameSqlVal</a> <a id="3087" class="Symbol">(</a><a id="3088" href="StateSizedIO.LIB.HDBC.HDBC.html#2319" class="InductiveConstructor">sqlString</a> <a id="3098" class="Symbol">_)</a>   <a id="3103" class="Symbol">=</a> <a id="3105" class="String">&quot;[String]&quot;</a>
<a id="3116" href="StateSizedIO.LIB.HDBC.HDBC.html#3035" class="Function">toTypeNameSqlVal</a> <a id="3133" class="Symbol">(</a><a id="3134" href="StateSizedIO.LIB.HDBC.HDBC.html#2352" class="InductiveConstructor">sqlInteger</a> <a id="3145" class="Symbol">_)</a>  <a id="3149" class="Symbol">=</a> <a id="3151" class="String">&quot;[Integer]&quot;</a>
<a id="3163" href="StateSizedIO.LIB.HDBC.HDBC.html#3035" class="Function">toTypeNameSqlVal</a> <a id="3180" href="StateSizedIO.LIB.HDBC.HDBC.html#2380" class="InductiveConstructor">sqlNull</a>         <a id="3196" class="Symbol">=</a> <a id="3198" class="String">&quot;SqlValNull&quot;</a>
<a id="3211" href="StateSizedIO.LIB.HDBC.HDBC.html#3035" class="Function">toTypeNameSqlVal</a> <a id="3228" href="StateSizedIO.LIB.HDBC.HDBC.html#2404" class="InductiveConstructor">sqlUndefined</a>    <a id="3244" class="Symbol">=</a> <a id="3246" class="String">&quot;SqlValUndefined&quot;</a>


<a id="toStringListSqlVal"></a><a id="3266" href="StateSizedIO.LIB.HDBC.HDBC.html#3266" class="Function">toStringListSqlVal</a> <a id="3285" class="Symbol">:</a> <a id="3287" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="3292" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a> <a id="3299" class="Symbol">→</a> <a id="3301" href="Agda.Builtin.String.html#309" class="Postulate">String</a>
<a id="3308" href="StateSizedIO.LIB.HDBC.HDBC.html#3266" class="Function">toStringListSqlVal</a> <a id="3327" class="Symbol">(</a><a id="3328" href="StateSizedIO.LIB.HDBC.HDBC.html#3328" class="Bound">x</a> <a id="3330" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="3332" href="StateSizedIO.LIB.HDBC.HDBC.html#3332" class="Bound">xs</a><a id="3334" class="Symbol">)</a> <a id="3336" class="Symbol">=</a> <a id="3338" href="StateSizedIO.LIB.HDBC.HDBC.html#2811" class="Function">toStringSqlVal</a> <a id="3353" href="StateSizedIO.LIB.HDBC.HDBC.html#3328" class="Bound">x</a> <a id="3355" href="StateSizedIO.LIB.HDBC.HDBC.html#180" class="Function Operator">++Str</a> <a id="3361" class="String">&quot;\n&quot;</a> <a id="3366" href="StateSizedIO.LIB.HDBC.HDBC.html#180" class="Function Operator">++Str</a> <a id="3372" href="StateSizedIO.LIB.HDBC.HDBC.html#3266" class="Function">toStringListSqlVal</a> <a id="3391" href="StateSizedIO.LIB.HDBC.HDBC.html#3332" class="Bound">xs</a>
<a id="3394" href="StateSizedIO.LIB.HDBC.HDBC.html#3266" class="Function">toStringListSqlVal</a> <a id="3413" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="3416" class="Symbol">=</a> <a id="3418" class="String">&quot;&quot;</a>



<a id="3424" class="Comment">-- Types</a>
<a id="3433" class="Comment">--</a>
<a id="3436" class="Keyword">postulate</a> <a id="Connection"></a><a id="3446" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="3457" class="Symbol">:</a> <a id="3459" href="Agda.Primitive.html#311" class="Primitive">Set</a>
<a id="3463" class="Symbol">{-#</a> <a id="3467" class="Keyword">COMPILE</a> <a id="3475" class="Keyword">GHC</a> <a id="3479" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="3490" class="Pragma">=</a> <a id="3492" class="Pragma">type</a> <a id="3497" class="Pragma">Database.HDBC.Sqlite3.Connection</a> <a id="3530" class="Symbol">#-}</a>


<a id="3536" class="Keyword">postulate</a> <a id="Statement"></a><a id="3546" href="StateSizedIO.LIB.HDBC.HDBC.html#3546" class="Postulate">Statement</a> <a id="3556" class="Symbol">:</a> <a id="3558" href="Agda.Primitive.html#311" class="Primitive">Set</a>
<a id="3562" class="Symbol">{-#</a> <a id="3566" class="Keyword">COMPILE</a> <a id="3574" class="Keyword">GHC</a> <a id="3578" href="StateSizedIO.LIB.HDBC.HDBC.html#3546" class="Postulate">Statement</a> <a id="3588" class="Pragma">=</a> <a id="3590" class="Pragma">type</a> <a id="3595" class="Pragma">Database.HDBC.Statement</a> <a id="3619" class="Symbol">#-}</a>

<a id="3624" class="Keyword">postulate</a> <a id="PairStringSqlValue"></a><a id="3634" href="StateSizedIO.LIB.HDBC.HDBC.html#3634" class="Postulate">PairStringSqlValue</a> <a id="3653" class="Symbol">:</a> <a id="3655" href="Agda.Primitive.html#311" class="Primitive">Set</a>
<a id="3659" class="Symbol">{-#</a> <a id="3663" class="Keyword">COMPILE</a> <a id="3671" class="Keyword">GHC</a> <a id="3675" href="StateSizedIO.LIB.HDBC.HDBC.html#3634" class="Postulate">PairStringSqlValue</a> <a id="3694" class="Pragma">=</a> <a id="3696" class="Pragma">type</a> <a id="3701" class="Pragma">(String,</a> <a id="3710" class="Pragma">Database.HDBC.SqlValue.SqlValue)</a> <a id="3743" class="Symbol">#-}</a>


<a id="3749" class="Comment">-- trivial helpers</a>
<a id="3768" class="Comment">--</a>
<a id="3771" class="Keyword">postulate</a> <a id="fstString"></a><a id="3781" href="StateSizedIO.LIB.HDBC.HDBC.html#3781" class="Postulate">fstString</a> <a id="3791" class="Symbol">:</a> <a id="3793" href="StateSizedIO.LIB.HDBC.HDBC.html#3634" class="Postulate">PairStringSqlValue</a> <a id="3812" class="Symbol">→</a> <a id="3814" href="Agda.Builtin.String.html#309" class="Postulate">String</a>
<a id="3821" class="Symbol">{-#</a> <a id="3825" class="Keyword">COMPILE</a> <a id="3833" class="Keyword">GHC</a> <a id="3837" href="StateSizedIO.LIB.HDBC.HDBC.html#3781" class="Postulate">fstString</a> <a id="3847" class="Pragma">=</a> <a id="3849" class="Pragma">(\(a</a> <a id="3854" class="Pragma">,</a> <a id="3856" class="Pragma">b)</a> <a id="3859" class="Pragma">-&gt;</a> <a id="3862" class="Pragma">Data.Text.pack</a> <a id="3877" class="Pragma">a)</a> <a id="3880" class="Symbol">#-}</a>

<a id="3885" class="Keyword">postulate</a> <a id="sndSqlValue"></a><a id="3895" href="StateSizedIO.LIB.HDBC.HDBC.html#3895" class="Postulate">sndSqlValue</a> <a id="3907" class="Symbol">:</a> <a id="3909" href="StateSizedIO.LIB.HDBC.HDBC.html#3634" class="Postulate">PairStringSqlValue</a> <a id="3928" class="Symbol">→</a> <a id="3930" href="StateSizedIO.LIB.HDBC.HDBC.html#2553" class="Postulate">SqlValue</a>
<a id="3939" class="Symbol">{-#</a> <a id="3943" class="Keyword">COMPILE</a> <a id="3951" class="Keyword">GHC</a> <a id="3955" href="StateSizedIO.LIB.HDBC.HDBC.html#3895" class="Postulate">sndSqlValue</a> <a id="3967" class="Pragma">=</a> <a id="3969" class="Pragma">(\(a</a> <a id="3974" class="Pragma">,</a> <a id="3976" class="Pragma">b)</a> <a id="3979" class="Pragma">-&gt;</a> <a id="3982" class="Pragma">b)</a> <a id="3985" class="Symbol">#-}</a>

<a id="convertPair"></a><a id="3990" href="StateSizedIO.LIB.HDBC.HDBC.html#3990" class="Function">convertPair</a> <a id="4002" class="Symbol">:</a> <a id="4004" href="StateSizedIO.LIB.HDBC.HDBC.html#3634" class="Postulate">PairStringSqlValue</a> <a id="4023" class="Symbol">→</a> <a id="4025" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="4032" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4034" href="StateSizedIO.LIB.HDBC.HDBC.html#2553" class="Postulate">SqlValue</a>
<a id="4043" href="StateSizedIO.LIB.HDBC.HDBC.html#3990" class="Function">convertPair</a> <a id="4055" href="StateSizedIO.LIB.HDBC.HDBC.html#4055" class="Bound">x</a> <a id="4057" class="Symbol">=</a> <a id="4059" href="StateSizedIO.LIB.HDBC.HDBC.html#3781" class="Postulate">fstString</a> <a id="4069" href="StateSizedIO.LIB.HDBC.HDBC.html#4055" class="Bound">x</a> <a id="4071" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4073" href="StateSizedIO.LIB.HDBC.HDBC.html#3895" class="Postulate">sndSqlValue</a> <a id="4085" href="StateSizedIO.LIB.HDBC.HDBC.html#4055" class="Bound">x</a>

<a id="4088" class="Comment">-- connect to Sqlite database</a>
<a id="4118" class="Comment">--</a>
<a id="4121" class="Keyword">postulate</a> <a id="nativeConnectDB"></a><a id="4131" href="StateSizedIO.LIB.HDBC.HDBC.html#4131" class="Postulate">nativeConnectDB</a> <a id="4147" class="Symbol">:</a> <a id="4149" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="4156" class="Symbol">→</a> <a id="4158" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="4161" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a>
<a id="4172" class="Symbol">{-#</a> <a id="4176" class="Keyword">COMPILE</a> <a id="4184" class="Keyword">GHC</a> <a id="4188" href="StateSizedIO.LIB.HDBC.HDBC.html#4131" class="Postulate">nativeConnectDB</a> <a id="4204" class="Pragma">=</a> <a id="4206" class="Pragma">(\tableName</a> <a id="4218" class="Pragma">-&gt;</a> <a id="4221" class="Pragma">Database.HDBC.Sqlite3.connectSqlite3</a> <a id="4258" class="Pragma">(Data.Text.unpack</a> <a id="4276" class="Pragma">tableName))</a> <a id="4288" class="Symbol">#-}</a>


<a id="4294" class="Comment">--</a>
<a id="4297" class="Comment">-- HDBC interface</a>
<a id="4315" class="Comment">--</a>

<a id="4319" class="Keyword">postulate</a> <a id="nativeDisconnect"></a><a id="4329" href="StateSizedIO.LIB.HDBC.HDBC.html#4329" class="Postulate">nativeDisconnect</a> <a id="4346" class="Symbol">:</a> <a id="4348" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="4359" class="Symbol">→</a> <a id="4361" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="4364" href="Unit.html#28" class="Record">Unit</a>
<a id="4369" class="Symbol">{-#</a> <a id="4373" class="Keyword">COMPILE</a> <a id="4381" class="Keyword">GHC</a> <a id="4385" href="StateSizedIO.LIB.HDBC.HDBC.html#4329" class="Postulate">nativeDisconnect</a> <a id="4402" class="Pragma">=</a> <a id="4404" class="Pragma">Database.HDBC.disconnect</a> <a id="4429" class="Symbol">#-}</a>

<a id="4434" class="Keyword">postulate</a> <a id="nativeCommit"></a><a id="4444" href="StateSizedIO.LIB.HDBC.HDBC.html#4444" class="Postulate">nativeCommit</a> <a id="4457" class="Symbol">:</a> <a id="4459" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="4470" class="Symbol">→</a> <a id="4472" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="4475" href="Unit.html#28" class="Record">Unit</a>
<a id="4480" class="Symbol">{-#</a> <a id="4484" class="Keyword">COMPILE</a> <a id="4492" class="Keyword">GHC</a> <a id="4496" href="StateSizedIO.LIB.HDBC.HDBC.html#4444" class="Postulate">nativeCommit</a> <a id="4509" class="Pragma">=</a> <a id="4511" class="Pragma">Database.HDBC.commit</a> <a id="4532" class="Symbol">#-}</a>

<a id="4537" class="Keyword">postulate</a> <a id="nativeRollback"></a><a id="4547" href="StateSizedIO.LIB.HDBC.HDBC.html#4547" class="Postulate">nativeRollback</a> <a id="4562" class="Symbol">:</a> <a id="4564" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="4575" class="Symbol">→</a> <a id="4577" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="4580" href="Unit.html#28" class="Record">Unit</a>
<a id="4585" class="Symbol">{-#</a> <a id="4589" class="Keyword">COMPILE</a> <a id="4597" class="Keyword">GHC</a> <a id="4601" href="StateSizedIO.LIB.HDBC.HDBC.html#4547" class="Postulate">nativeRollback</a> <a id="4616" class="Pragma">=</a> <a id="4618" class="Pragma">Database.HDBC.rollback</a> <a id="4641" class="Symbol">#-}</a>


<a id="4647" class="Comment">-- returns the number of modified rows</a>
<a id="4686" class="Comment">--</a>
<a id="4689" class="Keyword">postulate</a> <a id="nativeRunSqlValue"></a><a id="4699" href="StateSizedIO.LIB.HDBC.HDBC.html#4699" class="Postulate">nativeRunSqlValue</a> <a id="4717" class="Symbol">:</a> <a id="4719" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="4730" class="Symbol">→</a> <a id="4732" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="4739" class="Symbol">→</a> <a id="4741" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="4746" href="StateSizedIO.LIB.HDBC.HDBC.html#2553" class="Postulate">SqlValue</a> <a id="4755" class="Symbol">→</a> <a id="4757" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="4760" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>
<a id="4762" class="Symbol">{-#</a> <a id="4766" class="Keyword">COMPILE</a> <a id="4774" class="Keyword">GHC</a> <a id="4778" href="StateSizedIO.LIB.HDBC.HDBC.html#4699" class="Postulate">nativeRunSqlValue</a> <a id="4796" class="Pragma">=</a> <a id="4798" class="Pragma">(\conn</a> <a id="4805" class="Pragma">str</a> <a id="4809" class="Pragma">values</a> <a id="4816" class="Pragma">-&gt;</a> <a id="4819" class="Pragma">Database.HDBC.run</a> <a id="4837" class="Pragma">conn</a> <a id="4842" class="Pragma">(Data.Text.unpack</a> <a id="4860" class="Pragma">str)</a> <a id="4865" class="Pragma">values)</a> <a id="4873" class="Symbol">#-}</a>

<a id="nativeRunSqlValueAgda"></a><a id="4878" href="StateSizedIO.LIB.HDBC.HDBC.html#4878" class="Function">nativeRunSqlValueAgda</a> <a id="4900" class="Symbol">:</a> <a id="4902" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="4913" class="Symbol">→</a> <a id="4915" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="4922" class="Symbol">→</a> <a id="4924" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="4929" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a> <a id="4936" class="Symbol">→</a> <a id="4938" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="4941" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>
<a id="4943" href="StateSizedIO.LIB.HDBC.HDBC.html#4878" class="Function">nativeRunSqlValueAgda</a> <a id="4965" href="StateSizedIO.LIB.HDBC.HDBC.html#4965" class="Bound">conn</a> <a id="4970" href="StateSizedIO.LIB.HDBC.HDBC.html#4970" class="Bound">str</a> <a id="4974" href="StateSizedIO.LIB.HDBC.HDBC.html#4974" class="Bound">values</a> <a id="4981" class="Symbol">=</a> <a id="4983" href="StateSizedIO.LIB.HDBC.HDBC.html#4699" class="Postulate">nativeRunSqlValue</a> <a id="5001" href="StateSizedIO.LIB.HDBC.HDBC.html#4965" class="Bound">conn</a> <a id="5006" href="StateSizedIO.LIB.HDBC.HDBC.html#4970" class="Bound">str</a> <a id="5010" class="Symbol">(</a><a id="5011" href="Data.List.Base.html#1544" class="Function">map</a> <a id="5015" href="StateSizedIO.LIB.HDBC.HDBC.html#2735" class="Postulate">toSqlValue</a> <a id="5026" href="StateSizedIO.LIB.HDBC.HDBC.html#4974" class="Bound">values</a><a id="5032" class="Symbol">)</a>

<a id="5035" class="Keyword">postulate</a> <a id="nativePrepare"></a><a id="5045" href="StateSizedIO.LIB.HDBC.HDBC.html#5045" class="Postulate">nativePrepare</a> <a id="5059" class="Symbol">:</a> <a id="5061" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="5072" class="Symbol">→</a> <a id="5074" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="5081" class="Symbol">→</a> <a id="5083" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="5086" href="StateSizedIO.LIB.HDBC.HDBC.html#3546" class="Postulate">Statement</a>
<a id="5096" class="Symbol">{-#</a> <a id="5100" class="Keyword">COMPILE</a> <a id="5108" class="Keyword">GHC</a> <a id="5112" href="StateSizedIO.LIB.HDBC.HDBC.html#5045" class="Postulate">nativePrepare</a> <a id="5126" class="Pragma">=</a> <a id="5128" class="Pragma">(\conn</a> <a id="5135" class="Pragma">str</a> <a id="5139" class="Pragma">-&gt;</a> <a id="5142" class="Pragma">Database.HDBC.prepare</a> <a id="5164" class="Pragma">conn</a> <a id="5169" class="Pragma">(Data.Text.unpack</a> <a id="5187" class="Pragma">str))</a> <a id="5193" class="Symbol">#-}</a>



<a id="5200" class="Keyword">postulate</a> <a id="nativeExecuteSqlValue"></a><a id="5210" href="StateSizedIO.LIB.HDBC.HDBC.html#5210" class="Postulate">nativeExecuteSqlValue</a> <a id="5232" class="Symbol">:</a> <a id="5234" href="StateSizedIO.LIB.HDBC.HDBC.html#3546" class="Postulate">Statement</a> <a id="5244" class="Symbol">→</a> <a id="5246" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="5251" href="StateSizedIO.LIB.HDBC.HDBC.html#2553" class="Postulate">SqlValue</a> <a id="5260" class="Symbol">→</a> <a id="5262" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="5265" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>
<a id="5267" class="Symbol">{-#</a> <a id="5271" class="Keyword">COMPILE</a> <a id="5279" class="Keyword">GHC</a> <a id="5283" href="StateSizedIO.LIB.HDBC.HDBC.html#5210" class="Postulate">nativeExecuteSqlValue</a> <a id="5305" class="Pragma">=</a> <a id="5307" class="Pragma">Database.HDBC.execute</a> <a id="5329" class="Symbol">#-}</a>

<a id="nativeExecute"></a><a id="5334" href="StateSizedIO.LIB.HDBC.HDBC.html#5334" class="Function">nativeExecute</a> <a id="5348" class="Symbol">:</a> <a id="5350" href="StateSizedIO.LIB.HDBC.HDBC.html#3546" class="Postulate">Statement</a> <a id="5360" class="Symbol">→</a> <a id="5362" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="5367" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a> <a id="5374" class="Symbol">→</a> <a id="5376" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="5379" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>
<a id="5381" href="StateSizedIO.LIB.HDBC.HDBC.html#5334" class="Function">nativeExecute</a> <a id="5395" href="StateSizedIO.LIB.HDBC.HDBC.html#5395" class="Bound">statement</a> <a id="5405" href="StateSizedIO.LIB.HDBC.HDBC.html#5405" class="Bound">list</a> <a id="5410" class="Symbol">=</a> <a id="5412" href="StateSizedIO.LIB.HDBC.HDBC.html#5210" class="Postulate">nativeExecuteSqlValue</a> <a id="5434" href="StateSizedIO.LIB.HDBC.HDBC.html#5395" class="Bound">statement</a> <a id="5444" class="Symbol">(</a><a id="5445" href="Data.List.Base.html#1544" class="Function">map</a> <a id="5449" href="StateSizedIO.LIB.HDBC.HDBC.html#2735" class="Postulate">toSqlValue</a> <a id="5460" href="StateSizedIO.LIB.HDBC.HDBC.html#5405" class="Bound">list</a><a id="5464" class="Symbol">)</a>



<a id="5469" class="Keyword">postulate</a> <a id="runSqlValue"></a><a id="5479" href="StateSizedIO.LIB.HDBC.HDBC.html#5479" class="Postulate">runSqlValue</a> <a id="5491" class="Symbol">:</a> <a id="5493" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="5504" class="Symbol">→</a> <a id="5506" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="5513" class="Symbol">→</a> <a id="5515" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="5520" href="StateSizedIO.LIB.HDBC.HDBC.html#2553" class="Postulate">SqlValue</a> <a id="5529" class="Symbol">→</a> <a id="5531" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="5534" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>
<a id="5536" class="Symbol">{-#</a> <a id="5540" class="Keyword">COMPILE</a> <a id="5548" class="Keyword">GHC</a> <a id="5552" href="StateSizedIO.LIB.HDBC.HDBC.html#5479" class="Postulate">runSqlValue</a> <a id="5564" class="Pragma">=</a> <a id="5566" class="Pragma">(\conn</a> <a id="5573" class="Pragma">str</a> <a id="5577" class="Pragma">list</a> <a id="5582" class="Pragma">-&gt;</a> <a id="5585" class="Pragma">Database.HDBC.run</a> <a id="5603" class="Pragma">conn</a> <a id="5608" class="Pragma">(Data.Text.unpack</a> <a id="5626" class="Pragma">str)</a> <a id="5631" class="Pragma">list)</a> <a id="5637" class="Symbol">#-}</a>


<a id="nativeRun"></a><a id="5643" href="StateSizedIO.LIB.HDBC.HDBC.html#5643" class="Function">nativeRun</a> <a id="5653" class="Symbol">:</a> <a id="5655" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="5666" class="Symbol">→</a> <a id="5668" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="5675" class="Symbol">→</a> <a id="5677" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="5682" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a> <a id="5689" class="Symbol">→</a> <a id="5691" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="5694" href="Agda.Builtin.Int.html#219" class="Datatype">ℤ</a>
<a id="5696" href="StateSizedIO.LIB.HDBC.HDBC.html#5643" class="Function">nativeRun</a> <a id="5706" href="StateSizedIO.LIB.HDBC.HDBC.html#5706" class="Bound">conn</a> <a id="5711" href="StateSizedIO.LIB.HDBC.HDBC.html#5711" class="Bound">str</a> <a id="5715" href="StateSizedIO.LIB.HDBC.HDBC.html#5715" class="Bound">list</a> <a id="5720" class="Symbol">=</a> <a id="5722" href="StateSizedIO.LIB.HDBC.HDBC.html#5479" class="Postulate">runSqlValue</a> <a id="5734" href="StateSizedIO.LIB.HDBC.HDBC.html#5706" class="Bound">conn</a> <a id="5739" href="StateSizedIO.LIB.HDBC.HDBC.html#5711" class="Bound">str</a> <a id="5743" class="Symbol">(</a><a id="5744" href="Data.List.Base.html#1544" class="Function">map</a> <a id="5748" href="StateSizedIO.LIB.HDBC.HDBC.html#2735" class="Postulate">toSqlValue</a> <a id="5759" href="StateSizedIO.LIB.HDBC.HDBC.html#5715" class="Bound">list</a><a id="5763" class="Symbol">)</a>


<a id="5767" class="Keyword">postulate</a> <a id="getTables"></a><a id="5777" href="StateSizedIO.LIB.HDBC.HDBC.html#5777" class="Postulate">getTables</a> <a id="5787" class="Symbol">:</a> <a id="5789" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="5800" class="Symbol">→</a> <a id="5802" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="5805" class="Symbol">(</a><a id="5806" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="5811" href="Agda.Builtin.String.html#309" class="Postulate">String</a><a id="5817" class="Symbol">)</a>
<a id="5819" class="Symbol">{-#</a> <a id="5823" class="Keyword">COMPILE</a> <a id="5831" class="Keyword">GHC</a> <a id="5835" href="StateSizedIO.LIB.HDBC.HDBC.html#5777" class="Postulate">getTables</a> <a id="5845" class="Pragma">=</a> <a id="5847" class="Pragma">(\conn</a> <a id="5854" class="Pragma">-&gt;</a> <a id="5857" class="Pragma">(Database.HDBC.getTables</a> <a id="5882" class="Pragma">conn)</a> <a id="5888" class="Pragma">&gt;&gt;=</a> <a id="5892" class="Pragma">(\x</a> <a id="5896" class="Pragma">-&gt;</a> <a id="5899" class="Pragma">return</a> <a id="5906" class="Pragma">$</a> <a id="5908" class="Pragma">map</a> <a id="5912" class="Pragma">Data.Text.pack</a> <a id="5927" class="Pragma">x)</a> <a id="5930" class="Pragma">)</a> <a id="5932" class="Symbol">#-}</a>


<a id="5938" class="Keyword">postulate</a> <a id="fetchAllRowsALStrictSqlValue"></a><a id="5948" href="StateSizedIO.LIB.HDBC.HDBC.html#5948" class="Postulate">fetchAllRowsALStrictSqlValue</a> <a id="5977" class="Symbol">:</a> <a id="5979" href="StateSizedIO.LIB.HDBC.HDBC.html#3546" class="Postulate">Statement</a> <a id="5989" class="Symbol">→</a> <a id="5991" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="5994" class="Symbol">(</a><a id="5995" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="6000" class="Symbol">(</a><a id="6001" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="6006" href="StateSizedIO.LIB.HDBC.HDBC.html#3634" class="Postulate">PairStringSqlValue</a><a id="6024" class="Symbol">))</a>
<a id="6027" class="Symbol">{-#</a> <a id="6031" class="Keyword">COMPILE</a> <a id="6039" class="Keyword">GHC</a> <a id="6043" href="StateSizedIO.LIB.HDBC.HDBC.html#5948" class="Postulate">fetchAllRowsALStrictSqlValue</a> <a id="6072" class="Pragma">=</a> <a id="6074" class="Pragma">(\statement</a> <a id="6086" class="Pragma">-&gt;</a> <a id="6089" class="Pragma">(Database.HDBC.fetchAllRowsAL&#39;</a> <a id="6120" class="Pragma">statement))</a> <a id="6132" class="Symbol">#-}</a>

<a id="nativeFetchAllRowsAL&#39;"></a><a id="6137" href="StateSizedIO.LIB.HDBC.HDBC.html#6137" class="Function">nativeFetchAllRowsAL&#39;</a> <a id="6159" class="Symbol">:</a> <a id="6161" href="StateSizedIO.LIB.HDBC.HDBC.html#3546" class="Postulate">Statement</a> <a id="6171" class="Symbol">→</a> <a id="6173" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="6176" class="Symbol">(</a><a id="6177" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="6182" class="Symbol">(</a><a id="6183" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="6188" class="Symbol">(</a><a id="6189" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="6196" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6198" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a><a id="6204" class="Symbol">)))</a>
<a id="6208" href="StateSizedIO.LIB.HDBC.HDBC.html#6137" class="Function">nativeFetchAllRowsAL&#39;</a> <a id="6230" href="StateSizedIO.LIB.HDBC.HDBC.html#6230" class="Bound">statement</a> <a id="6240" class="Symbol">=</a> <a id="6242" href="StateSizedIO.LIB.HDBC.HDBC.html#5948" class="Postulate">fetchAllRowsALStrictSqlValue</a> <a id="6271" href="StateSizedIO.LIB.HDBC.HDBC.html#6230" class="Bound">statement</a> <a id="6281" href="StateSizedIO.LIB.HDBC.HDBC.html#468" class="Postulate Operator">&gt;&gt;=</a> <a id="6285" class="Symbol">λ</a> <a id="6287" href="StateSizedIO.LIB.HDBC.HDBC.html#6287" class="Bound">list</a> <a id="6292" class="Symbol">→</a>
                            <a id="6322" href="StateSizedIO.LIB.HDBC.HDBC.html#445" class="Postulate">return</a> <a id="6329" class="Symbol">(</a><a id="6330" href="Data.List.Base.html#1544" class="Function">map</a> <a id="6334" class="Symbol">(</a><a id="6335" href="Data.List.Base.html#1544" class="Function">map</a> <a id="6339" class="Symbol">(λ</a> <a id="6342" href="StateSizedIO.LIB.HDBC.HDBC.html#6342" class="Bound">y</a> <a id="6344" class="Symbol">→</a> <a id="6346" href="StateSizedIO.LIB.HDBC.HDBC.html#232" class="Function">mapProduct</a> <a id="6357" class="Symbol">(λ</a> <a id="6360" href="StateSizedIO.LIB.HDBC.HDBC.html#6360" class="Bound">x</a> <a id="6362" class="Symbol">→</a> <a id="6364" href="StateSizedIO.LIB.HDBC.HDBC.html#6360" class="Bound">x</a><a id="6365" class="Symbol">)</a> <a id="6367" href="StateSizedIO.LIB.HDBC.HDBC.html#2647" class="Postulate">toSqlVal</a> <a id="6376" class="Symbol">(</a><a id="6377" href="StateSizedIO.LIB.HDBC.HDBC.html#3990" class="Function">convertPair</a> <a id="6389" href="StateSizedIO.LIB.HDBC.HDBC.html#6342" class="Bound">y</a><a id="6390" class="Symbol">)))</a> <a id="6394" href="StateSizedIO.LIB.HDBC.HDBC.html#6287" class="Bound">list</a><a id="6398" class="Symbol">)</a>

<a id="nativePrintList"></a><a id="6401" href="StateSizedIO.LIB.HDBC.HDBC.html#6401" class="Function">nativePrintList</a> <a id="6417" class="Symbol">:</a> <a id="6419" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="6424" class="Symbol">(</a><a id="6425" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="6430" class="Symbol">(</a><a id="6431" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="6438" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6440" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a><a id="6446" class="Symbol">))</a> <a id="6449" class="Symbol">→</a> <a id="6451" href="Agda.Builtin.String.html#309" class="Postulate">String</a>
<a id="6458" href="StateSizedIO.LIB.HDBC.HDBC.html#6401" class="Function">nativePrintList</a> <a id="6474" href="StateSizedIO.LIB.HDBC.HDBC.html#6474" class="Bound">l</a> <a id="6476" class="Symbol">=</a> <a id="6478" href="Data.String.Base.html#2767" class="Function">unlines</a> <a id="6486" class="Symbol">(</a><a id="6487" href="Data.List.Base.html#1544" class="Function">map</a> <a id="6491" href="StateSizedIO.LIB.HDBC.HDBC.html#6527" class="Function">concat&#39;</a> <a id="6499" href="StateSizedIO.LIB.HDBC.HDBC.html#6739" class="Function">listListString</a><a id="6513" class="Symbol">)</a>
  <a id="6517" class="Keyword">where</a>
    <a id="6527" href="StateSizedIO.LIB.HDBC.HDBC.html#6527" class="Function">concat&#39;</a> <a id="6535" class="Symbol">=</a> <a id="6537" href="Data.List.Base.html#4192" class="Function">foldr</a> <a id="6543" class="Symbol">(λ</a> <a id="6546" href="StateSizedIO.LIB.HDBC.HDBC.html#6546" class="Bound">x</a> <a id="6548" href="StateSizedIO.LIB.HDBC.HDBC.html#6548" class="Bound">y</a> <a id="6550" class="Symbol">→</a> <a id="6552" href="StateSizedIO.LIB.HDBC.HDBC.html#6546" class="Bound">x</a> <a id="6554" href="StateSizedIO.LIB.HDBC.HDBC.html#180" class="Function Operator">++Str</a> <a id="6560" class="String">&quot;, &quot;</a> <a id="6565" href="StateSizedIO.LIB.HDBC.HDBC.html#180" class="Function Operator">++Str</a> <a id="6571" href="StateSizedIO.LIB.HDBC.HDBC.html#6548" class="Bound">y</a><a id="6572" class="Symbol">)</a> <a id="6574" class="String">&quot;&quot;</a>
    <a id="6581" href="StateSizedIO.LIB.HDBC.HDBC.html#6581" class="Function">toStr</a> <a id="6587" class="Symbol">:</a> <a id="6589" href="Agda.Builtin.String.html#309" class="Postulate">String</a> <a id="6596" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6598" href="StateSizedIO.LIB.HDBC.HDBC.html#2298" class="Datatype">SqlVal</a> <a id="6605" class="Symbol">→</a> <a id="6607" href="Agda.Builtin.String.html#309" class="Postulate">String</a>
    <a id="6618" href="StateSizedIO.LIB.HDBC.HDBC.html#6581" class="Function">toStr</a> <a id="6624" class="Symbol">(</a><a id="6625" href="StateSizedIO.LIB.HDBC.HDBC.html#6625" class="Bound">str</a> <a id="6629" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="6631" href="StateSizedIO.LIB.HDBC.HDBC.html#6631" class="Bound">val</a><a id="6634" class="Symbol">)</a> <a id="6636" class="Symbol">=</a> <a id="6638" class="String">&quot;(&quot;</a> <a id="6642" href="StateSizedIO.LIB.HDBC.HDBC.html#180" class="Function Operator">++Str</a> <a id="6648" href="StateSizedIO.LIB.HDBC.HDBC.html#6625" class="Bound">str</a> <a id="6652" href="StateSizedIO.LIB.HDBC.HDBC.html#180" class="Function Operator">++Str</a> <a id="6658" class="String">&quot;, &quot;</a> <a id="6663" href="StateSizedIO.LIB.HDBC.HDBC.html#180" class="Function Operator">++Str</a> <a id="6669" href="StateSizedIO.LIB.HDBC.HDBC.html#2811" class="Function">toStringSqlVal</a> <a id="6684" href="StateSizedIO.LIB.HDBC.HDBC.html#6631" class="Bound">val</a> <a id="6688" href="StateSizedIO.LIB.HDBC.HDBC.html#180" class="Function Operator">++Str</a> <a id="6694" class="String">&quot; &quot;</a> <a id="6698" href="StateSizedIO.LIB.HDBC.HDBC.html#180" class="Function Operator">++Str</a> <a id="6704" href="StateSizedIO.LIB.HDBC.HDBC.html#3035" class="Function">toTypeNameSqlVal</a> <a id="6721" href="StateSizedIO.LIB.HDBC.HDBC.html#6631" class="Bound">val</a> <a id="6725" href="StateSizedIO.LIB.HDBC.HDBC.html#180" class="Function Operator">++Str</a> <a id="6731" class="String">&quot;)&quot;</a>
    <a id="6739" href="StateSizedIO.LIB.HDBC.HDBC.html#6739" class="Function">listListString</a> <a id="6754" class="Symbol">=</a> <a id="6756" href="Data.List.Base.html#1544" class="Function">map</a> <a id="6760" class="Symbol">(</a><a id="6761" href="Data.List.Base.html#1544" class="Function">map</a> <a id="6765" href="StateSizedIO.LIB.HDBC.HDBC.html#6581" class="Function">toStr</a><a id="6770" class="Symbol">)</a> <a id="6772" href="StateSizedIO.LIB.HDBC.HDBC.html#6474" class="Bound">l</a>



<a id="dropTableIfExisits"></a><a id="6777" href="StateSizedIO.LIB.HDBC.HDBC.html#6777" class="Function">dropTableIfExisits</a> <a id="6796" class="Symbol">:</a> <a id="6798" href="StateSizedIO.LIB.HDBC.HDBC.html#3446" class="Postulate">Connection</a> <a id="6809" class="Symbol">→</a> <a id="6811" class="Symbol">(</a><a id="6812" href="StateSizedIO.LIB.HDBC.HDBC.html#6812" class="Bound">tableName</a> <a id="6822" class="Symbol">:</a> <a id="6824" href="Agda.Builtin.String.html#309" class="Postulate">String</a><a id="6830" class="Symbol">)</a> <a id="6832" class="Symbol">→</a>  <a id="6835" href="StateSizedIO.LIB.HDBC.HDBC.html#425" class="Postulate">IO</a> <a id="6838" href="Unit.html#28" class="Record">Unit</a>
<a id="6843" href="StateSizedIO.LIB.HDBC.HDBC.html#6777" class="Function">dropTableIfExisits</a> <a id="6862" href="StateSizedIO.LIB.HDBC.HDBC.html#6862" class="Bound">conn</a> <a id="6867" href="StateSizedIO.LIB.HDBC.HDBC.html#6867" class="Bound">tableName</a> <a id="6877" class="Symbol">=</a> <a id="6879" href="StateSizedIO.LIB.HDBC.HDBC.html#5643" class="Function">nativeRun</a> <a id="6889" href="StateSizedIO.LIB.HDBC.HDBC.html#6862" class="Bound">conn</a> <a id="6894" class="Symbol">(</a><a id="6895" class="String">&quot;DROP TABLE IF EXISTS &quot;</a> <a id="6919" href="StateSizedIO.LIB.HDBC.HDBC.html#180" class="Function Operator">++Str</a> <a id="6925" href="StateSizedIO.LIB.HDBC.HDBC.html#6867" class="Bound">tableName</a><a id="6934" class="Symbol">)</a> <a id="6936" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a> <a id="6939" href="StateSizedIO.LIB.HDBC.HDBC.html#468" class="Postulate Operator">&gt;&gt;=</a> <a id="6943" class="Symbol">λ</a> <a id="6945" href="StateSizedIO.LIB.HDBC.HDBC.html#6945" class="Bound">_</a> <a id="6947" class="Symbol">→</a> <a id="6949" href="StateSizedIO.LIB.HDBC.HDBC.html#445" class="Postulate">return</a> <a id="6956" class="Symbol">_</a>
</pre></body></html>