<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>StateSizedIO.LIB.DB.Serialization</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="StateSizedIO.LIB.DB.Serialization.html" class="Module">StateSizedIO.LIB.DB.Serialization</a> <a id="42" class="Keyword">where</a>

<a id="49" class="Keyword">open</a> <a id="54" class="Keyword">import</a> <a id="61" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="71" class="Keyword">open</a> <a id="76" class="Keyword">import</a> <a id="83" href="Data.String.html" class="Module">Data.String</a> <a id="95" class="Keyword">renaming</a> <a id="104" class="Symbol">(</a><a id="105" href="Data.String.Base.html#1101" class="Function Operator">_++_</a> <a id="110" class="Symbol">to</a> <a id="113" href="Data.String.Base.html#1101" class="Function Operator">_+++_</a><a id="118" class="Symbol">)</a>
<a id="120" class="Keyword">open</a> <a id="125" class="Keyword">import</a> <a id="132" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="Data.List.html" class="Module">Data.List</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.Product.html" class="Module">Data.Product</a> <a id="188" class="Keyword">hiding</a> <a id="195" class="Symbol">(</a><a id="196" href="Data.Product.html#2128" class="Function">map</a><a id="199" class="Symbol">)</a>
<a id="201" class="Keyword">open</a> <a id="206" class="Keyword">import</a> <a id="213" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="222" class="Keyword">hiding</a> <a id="229" class="Symbol">(</a><a id="230" href="Data.Vec.html#1864" class="Function">map</a><a id="233" class="Symbol">)</a>
<a id="235" class="Keyword">open</a> <a id="240" class="Keyword">import</a> <a id="247" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="260" class="Keyword">open</a> <a id="265" class="Keyword">import</a> <a id="272" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Data.Fin.html" class="Module">Data.Fin</a>

<a id="304" class="Keyword">open</a> <a id="309" class="Keyword">import</a> <a id="316" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="343" class="Keyword">hiding</a> <a id="350" class="Symbol">(</a><a id="351" href="Relation.Nullary.Decidable.html#1632" class="Function">map</a><a id="354" class="Symbol">)</a>


<a id="358" class="Keyword">open</a> <a id="363" class="Keyword">import</a> <a id="370" href="StateSizedIO.LIB.library.html" class="Module">StateSizedIO.LIB.library</a>
<a id="395" class="Keyword">open</a> <a id="400" class="Keyword">import</a> <a id="407" href="StateSizedIO.LIB.DB.Schema.html" class="Module">StateSizedIO.LIB.DB.Schema</a>


<a id="rowToQuestionsmarks"></a><a id="436" href="StateSizedIO.LIB.DB.Serialization.html#436" class="Function">rowToQuestionsmarks</a> <a id="456" class="Symbol">:</a> <a id="458" href="StateSizedIO.LIB.DB.Schema.html#800" class="Function">TableType</a> <a id="468" class="Symbol">→</a> <a id="470" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
<a id="477" href="StateSizedIO.LIB.DB.Serialization.html#436" class="Function">rowToQuestionsmarks</a> <a id="497" href="StateSizedIO.LIB.DB.Serialization.html#497" class="Bound">xs</a> <a id="500" class="Symbol">=</a> <a id="502" href="StateSizedIO.LIB.library.html#637" class="Function">concatIntersperse</a> <a id="520" class="String">&quot;,&quot;</a> <a id="524" class="Symbol">(</a><a id="525" href="Data.List.Base.html#1057" class="Function">map</a> <a id="529" class="Symbol">(λ</a> <a id="532" href="StateSizedIO.LIB.DB.Serialization.html#532" class="Bound">_</a> <a id="534" class="Symbol">→</a> <a id="536" class="String">&quot;?&quot;</a><a id="539" class="Symbol">)</a> <a id="541" href="StateSizedIO.LIB.DB.Serialization.html#497" class="Bound">xs</a><a id="543" class="Symbol">)</a>

<a id="insertCommand"></a><a id="546" href="StateSizedIO.LIB.DB.Serialization.html#546" class="Function">insertCommand</a> <a id="560" class="Symbol">:</a> <a id="562" class="Symbol">(</a><a id="563" href="StateSizedIO.LIB.DB.Serialization.html#563" class="Bound">schema</a> <a id="570" class="Symbol">:</a> <a id="572" href="StateSizedIO.LIB.DB.Schema.html#827" class="Function">Schema</a><a id="578" class="Symbol">)(</a><a id="580" href="StateSizedIO.LIB.DB.Serialization.html#580" class="Bound">tableNr</a> <a id="588" class="Symbol">:</a> <a id="590" href="Data.Fin.html#910" class="Datatype">Fin</a> <a id="594" class="Symbol">(</a><a id="595" href="StateSizedIO.LIB.DB.Schema.html#885" class="Function">nrTables</a> <a id="604" href="StateSizedIO.LIB.DB.Serialization.html#563" class="Bound">schema</a><a id="610" class="Symbol">))</a> <a id="613" class="Symbol">→</a> <a id="615" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
<a id="622" href="StateSizedIO.LIB.DB.Serialization.html#546" class="Function">insertCommand</a> <a id="636" href="StateSizedIO.LIB.DB.Serialization.html#636" class="Bound">schema</a> <a id="643" href="StateSizedIO.LIB.DB.Serialization.html#643" class="Bound">tblNr</a> <a id="649" class="Symbol">=</a> <a id="651" class="String">&quot;INSERT INTO &quot;</a>
                            <a id="694" href="Data.String.Base.html#1101" class="Function Operator">+++</a> <a id="698" href="StateSizedIO.LIB.DB.Schema.html#1586" class="Function">tableName</a> <a id="708" href="StateSizedIO.LIB.DB.Serialization.html#636" class="Bound">schema</a> <a id="715" href="StateSizedIO.LIB.DB.Serialization.html#643" class="Bound">tblNr</a> <a id="721" href="Data.String.Base.html#1101" class="Function Operator">+++</a>
                            <a id="753" class="String">&quot; VALUES (&quot;</a> <a id="765" href="Data.String.Base.html#1101" class="Function Operator">+++</a> <a id="769" href="StateSizedIO.LIB.DB.Serialization.html#436" class="Function">rowToQuestionsmarks</a> <a id="789" class="Symbol">(</a><a id="790" href="StateSizedIO.LIB.DB.Schema.html#1739" class="Function">tableType</a> <a id="800" href="StateSizedIO.LIB.DB.Serialization.html#636" class="Bound">schema</a> <a id="807" href="StateSizedIO.LIB.DB.Serialization.html#643" class="Bound">tblNr</a><a id="812" class="Symbol">)</a> <a id="814" href="Data.String.Base.html#1101" class="Function Operator">+++</a> <a id="818" class="String">&quot;)&quot;</a>



<a id="printForeignKeys"></a><a id="825" href="StateSizedIO.LIB.DB.Serialization.html#825" class="Function">printForeignKeys</a> <a id="842" class="Symbol">:</a> <a id="844" class="Symbol">(</a><a id="845" href="StateSizedIO.LIB.DB.Serialization.html#845" class="Bound">schema</a> <a id="852" class="Symbol">:</a> <a id="854" href="StateSizedIO.LIB.DB.Schema.html#827" class="Function">Schema</a><a id="860" class="Symbol">)</a>
                  <a id="880" class="Symbol">(</a><a id="881" class="Keyword">let</a> <a id="885" href="StateSizedIO.LIB.DB.Serialization.html#885" class="Bound">nrtables</a> <a id="894" class="Symbol">=</a> <a id="896" class="Symbol">(</a><a id="897" href="StateSizedIO.LIB.DB.Schema.html#885" class="Function">nrTables</a> <a id="906" href="StateSizedIO.LIB.DB.Serialization.html#845" class="Bound">schema</a><a id="912" class="Symbol">))</a>
                  <a id="933" class="Symbol">(</a><a id="934" href="StateSizedIO.LIB.DB.Serialization.html#934" class="Bound">mytable</a> <a id="942" class="Symbol">:</a> <a id="944" href="Data.Fin.html#910" class="Datatype">Fin</a> <a id="948" href="StateSizedIO.LIB.DB.Serialization.html#885" class="Bound">nrtables</a><a id="956" class="Symbol">)</a>
                  <a id="976" class="Symbol">(</a><a id="977" href="StateSizedIO.LIB.DB.Serialization.html#977" class="Bound">keys</a> <a id="982" class="Symbol">:</a> <a id="984" href="StateSizedIO.LIB.DB.Schema.html#2093" class="Function">ForeignKeys</a> <a id="996" href="StateSizedIO.LIB.DB.Serialization.html#845" class="Bound">schema</a> <a id="1003" href="StateSizedIO.LIB.DB.Serialization.html#934" class="Bound">mytable</a><a id="1010" class="Symbol">)</a>
                  <a id="1030" class="Symbol">→</a> <a id="1032" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
<a id="1039" href="StateSizedIO.LIB.DB.Serialization.html#825" class="Function">printForeignKeys</a> <a id="1056" href="StateSizedIO.LIB.DB.Serialization.html#1056" class="Bound">schema</a> <a id="1063" href="StateSizedIO.LIB.DB.Serialization.html#1063" class="Bound">mytable</a> <a id="1071" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1074" class="Symbol">=</a> <a id="1076" class="String">&quot;&quot;</a>
<a id="1079" href="StateSizedIO.LIB.DB.Serialization.html#825" class="Function">printForeignKeys</a> <a id="1096" href="StateSizedIO.LIB.DB.Serialization.html#1096" class="Bound">schema</a> <a id="1103" href="StateSizedIO.LIB.DB.Serialization.html#1103" class="Bound">mytable</a> <a id="1111" class="Symbol">((</a><a id="1113" href="StateSizedIO.LIB.DB.Serialization.html#1113" class="Bound">nrCol</a> <a id="1119" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="1121" class="Symbol">(</a><a id="1122" href="StateSizedIO.LIB.DB.Serialization.html#1122" class="Bound">foreignTable</a> <a id="1135" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="1137" href="StateSizedIO.LIB.DB.Serialization.html#1137" class="Bound">nrForeignColumn</a> <a id="1153" href="Data.Product.html#543" class="InductiveConstructor Operator">,</a> <a id="1155" class="Symbol">_))</a> <a id="1159" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1161" href="StateSizedIO.LIB.DB.Serialization.html#1161" class="Bound">keys</a><a id="1165" class="Symbol">)</a> <a id="1167" class="Symbol">=</a>
  <a id="1171" class="String">&quot;FOREIGN KEY(&quot;</a> <a id="1186" href="Data.String.Base.html#1101" class="Function Operator">+++</a> <a id="1190" href="StateSizedIO.LIB.DB.Serialization.html#1348" class="Function">columnName</a> <a id="1201" href="Data.String.Base.html#1101" class="Function Operator">+++</a> <a id="1205" class="String">&quot;) REFERENCES &quot;</a> <a id="1221" href="Data.String.Base.html#1101" class="Function Operator">+++</a>
  <a id="1227" href="StateSizedIO.LIB.DB.Serialization.html#1531" class="Function">foreighTableName</a> <a id="1244" href="Data.String.Base.html#1101" class="Function Operator">+++</a> <a id="1248" class="String">&quot; ( &quot;</a> <a id="1254" href="Data.String.Base.html#1101" class="Function Operator">+++</a> <a id="1258" href="StateSizedIO.LIB.DB.Serialization.html#1425" class="Function">foreignColumnName</a> <a id="1276" href="Data.String.Base.html#1101" class="Function Operator">+++</a> <a id="1280" class="String">&quot; ),&quot;</a> <a id="1286" href="Data.String.Base.html#1101" class="Function Operator">+++</a> <a id="1290" class="String">&quot;\n&quot;</a> <a id="1295" href="Data.String.Base.html#1101" class="Function Operator">+++</a> <a id="1299" href="StateSizedIO.LIB.DB.Serialization.html#825" class="Function">printForeignKeys</a> <a id="1316" href="StateSizedIO.LIB.DB.Serialization.html#1096" class="Bound">schema</a> <a id="1323" href="StateSizedIO.LIB.DB.Serialization.html#1103" class="Bound">mytable</a> <a id="1331" href="StateSizedIO.LIB.DB.Serialization.html#1161" class="Bound">keys</a>
  <a id="1338" class="Keyword">where</a>
    <a id="1348" href="StateSizedIO.LIB.DB.Serialization.html#1348" class="Function">columnName</a> <a id="1359" class="Symbol">:</a> <a id="1361" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
    <a id="1372" href="StateSizedIO.LIB.DB.Serialization.html#1348" class="Function">columnName</a> <a id="1383" class="Symbol">=</a> <a id="1385" href="StateSizedIO.LIB.DB.Schema.html#1125" class="Function">colName</a> <a id="1393" href="StateSizedIO.LIB.DB.Serialization.html#1096" class="Bound">schema</a> <a id="1400" href="StateSizedIO.LIB.DB.Serialization.html#1103" class="Bound">mytable</a> <a id="1408" href="StateSizedIO.LIB.DB.Serialization.html#1113" class="Bound">nrCol</a>
    <a id="1418" class="Comment">--</a>
    <a id="1425" href="StateSizedIO.LIB.DB.Serialization.html#1425" class="Function">foreignColumnName</a> <a id="1443" class="Symbol">:</a> <a id="1445" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
    <a id="1456" href="StateSizedIO.LIB.DB.Serialization.html#1425" class="Function">foreignColumnName</a> <a id="1474" class="Symbol">=</a> <a id="1476" href="StateSizedIO.LIB.DB.Schema.html#1125" class="Function">colName</a> <a id="1484" href="StateSizedIO.LIB.DB.Serialization.html#1096" class="Bound">schema</a> <a id="1491" href="StateSizedIO.LIB.DB.Serialization.html#1122" class="Bound">foreignTable</a> <a id="1504" href="StateSizedIO.LIB.DB.Serialization.html#1137" class="Bound">nrForeignColumn</a>
    <a id="1524" class="Comment">--</a>
    <a id="1531" href="StateSizedIO.LIB.DB.Serialization.html#1531" class="Function">foreighTableName</a> <a id="1548" class="Symbol">:</a> <a id="1550" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
    <a id="1561" href="StateSizedIO.LIB.DB.Serialization.html#1531" class="Function">foreighTableName</a> <a id="1578" class="Symbol">=</a> <a id="1580" href="StateSizedIO.LIB.DB.Schema.html#1586" class="Function">tableName</a> <a id="1590" href="StateSizedIO.LIB.DB.Serialization.html#1096" class="Bound">schema</a> <a id="1597" href="StateSizedIO.LIB.DB.Serialization.html#1122" class="Bound">foreignTable</a>
</pre></body></html>